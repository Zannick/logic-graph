name: Mt Ebih
short: Ebih

areas:
- name: Base Camp  # MARK: Base Camp
  on_entry: $reset_old_area(^newpos)
  map:
    save: [29, 12, 30, 13]
    west: [28, 12, 29, 13]
    east: [30, 12, 31, 13]
    health: [29, 10, 30, 11]
  data:
    save_point: Save Point
  datamap:
    map_spot:
      save: Menu > Kiengir Map > Ebih Base Camp
      west: Menu > Kiengir Map > Ebih Base Camp West
      east: Menu > Kiengir Map > Ebih Base Camp East
      health: Menu > Kiengir Map > Ebih Base Camp Health
  reset:
    _left_platform_moved: false
  spots:
    - name: East 11
      coord: [30.95, 10.35]
      local:
        - to: East 12
        - to: Staircase
        - to: Lake Access
          thru: [30.7, 11.8]
      exits:
        - to: Glacier > Grid 31,9-12 > Midair
          tags: [xshift]
        - to: Top Platform
          req: $platform and $hook and $hover
          # TODO: time or hook-hover movement
    - name: East 12
      coord: [30.95, 11.7]
      local:
        - to: Staircase
        - to: Lake Access
          thru: [30.7, 11.8]
        - to: Bunker Entry
          thru: [30.7, 11.8]
          jumps_down: [0, 1]
      exits:
        - to: Glacier > Grid 31,9-12 > West 12
          tags: [xshift]
    - name: Staircase
      coord: [30.4, 11.9]
      local:
        - to: East 12
          jumps: 1
        - to: Bunker Entry
          jumps_down: 2
        - to: Save Point
        - to: Lake Access
    - name: Save Point
      coord: [29.5, 12.55]
      local:
        - to: Staircase
          jumps: 6
        - to: Bunker Entry
        - to: Behind Vehicle
      exits:
        - to: Top Platform
          req: Nanite_Mist
          movement: mist1
        - to: Top Platform
          req: $mist2
          movement: mist2
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Bunker Entry
      coord: [30.225, 12.6]
      local:
        - to: Staircase
          jumps: 6
        - to: Save Point
          jumps: 1
        - to: Lake Access
      exits:
        - to: Interior > Bunker Interior > Entry
          tags: [interior]
    - name: Lake Access
      coord: [30.95, 12.7]
      local:
        - to: Bunker Entry
          jumps: 1
      exits:
        - to: Glacier > Lake Main Entrance > Ebih Access
          tags: [xshift]
    - name: Behind Vehicle
      coord: [28.8, 12.7]
      local:
        - to: Building Entry
          thru: [28.75, 12.35]
          jumps: [2, 1]
        - to: Save Point
          jumps: 1
        - to: Tent Entry
    - name: Building Entry
      coord: [28.95, 12.15]
      local:
        - to: Behind Vehicle
          jumps_down: 1
        - to: Tent Entry
          jumps_down: 2
        - to: Save Point
        - to: West 13
      exits:
        - to: Interior > Building Interior > Entry
          tags: [interior]
    - name: Tent Entry
      coord: [28.425, 12.7]
      local:
        - to: Building Entry
          jumps: 3
        - to: Behind Vehicle
        - to: West 13
          jumps: 1
      exits:
        - to: Interior > Tent Interior > Entry
          time: 0.5
          tags: [interior, tent]
    - name: West 13
      coord: [28.05, 12.55]
      local:
        - to: Tent Entry
      exits:
        - to: By Garage > East 13
          tags: [xshift]

    - name: West 11
      coord: [28.05, 10.6]
      local:
        - to: West Midair
        - to: Left Platform
      exits:
        - to: Left Platform
          req: $platform and $hook and not ^_left_platform_moved
        - to: Left Platform
          req: $hover and not ^_left_platform_moved
        - to: Observation Tower Room > East 11
          tags: [xshift]
    - name: West Midair
      coord: [28.35, 11]
      local:
        - to: West 12
        - to: Building Entry
        - to: Tent Entry
    # TODO: times needed
    - name: West 12
      coord: [28.05, 11.5]
      exits:
        - to: By Garage > East 12
          tags: [xshift]
    - name: Left Platform
      coord: [28.7, 10.8]
      exits:
        - to: Top Platform
          req: $hover and $hook
      actions:
        - name: Move Left Platform
          req: $activate and not ^_left_platform_moved
          do: ^_left_platform_moved = true
          to: Ebih > Base Camp > Left Platform Moved
    - name: Left Platform Moved
      coord: [29.4, 10.8]
      locations:
        - name: Item From The Side
          item: Health_Fragment
          canon: Ebih_Base_Camp_Fragment
      exits:
        - to: Top Platform
          req: $grab
          movement: base
          jumps: 2
        - to: Top Platform
          req: $hook
          movement: base
          jumps: 1
      actions:
        - name: Reset Left Platform
          req: $activate and ^_left_platform_moved
          do: ^_left_platform_moved = false
          to: Ebih > Base Camp > Left Platform
    - name: Top Platform
      coord: [29.5, 10.5]
      local:
        - to: Tent Entry
        - to: Building Entry
        - to: Save Point
        - to: Bunker Entry
        - to: Staircase
      locations:
        - name: Item
          item: Health_Fragment
          canon: Ebih_Base_Camp_Fragment
          tags: [standing]
      exits:
        - to: Left Platform
          req: $hover and not ^_left_platform_moved
        - to: Left Platform Moved
          req: ^_left_platform_moved

- name: By Garage  # MARK: By Garage
  on_entry: $reset_old_area(^newpos)
  map:
    health: [27, 11, 28, 12]
    garage: [27, 12, 28, 13]
    wbush: [26, 11, 27, 12]
  datamap:
    map_spot:
      health: Menu > Kiengir Map > Ebih By Garage Health
      garage: Menu > Kiengir Map > Ebih Garage
      wbush: Menu > Kiengir Map > Ebih By Garage NW
  spots:
    - name: East 13
      coord: [27.95, 12.55]
      local:
        - to: East Platform
          jumps: 2
        - to: Garage Entry
      exits:
        - to: Base Camp > West 13
          tags: [xshift]
    - name: East Platform
      coord: [27.5, 12.15]
      local:
        - to: Garage Entry
        - to: East 13
      exits:
        - to: Crawlspace Opening
          req: $grab
          time: 0.75
        - to: Crawlspace Opening
          req: $hook
          movement: base
          jumps: 1
        - to: Outcropping
          req: $grab
          time: 1.3
        - to: Outcropping
          req: $hook
          movement: base
          jumps: 2
    - name: Crawlspace Opening
      coord: [27.4, 11.9]
      data:
        flipside: Ebih Breach > In 'n Out > Center Rock East
      local:
        - to: Outcropping
          jumps: 1
        - to: East Platform
        - to: East 13
      exits:
        - to: Crawlspace
          req: ^mode == 'drone'
          movement: base
    - name: Crawlspace
      coord: [27.2, 11.9]
      locations:
        - name: Fragment
          item: Health_Fragment
          tags: [standing]
      exits:
        - to: Crawlspace Opening
          req: ^mode == 'drone'
          movement: base
    - name: Outcropping
      coord: [27.35, 11.7]
      local:
        - to: East Bush
        - to: Crawlspace Opening
        - to: East Platform
        - to: East 13
    - name: East Bush
      coord: [26.8, 11.95]
      local:
        - to: Outcropping
          jumps: 3
        - to: West Bush
        - to: Lower Platform
    - name: Lower Platform
      coord: [26.4, 12.35]
      local:
        - to: Garage Entry
          jumps_down: 1
        - to: East 13
      exits:
        - to: East Bush
          req: $grab or $climb
          time: 1.3
        - to: East Bush
          req: $hook
          movement: base
          jumps: 2
        - to: West Bush
          req: $grab or $climb
          time: 1.8
        - to: West Bush
          req: $hook
          movement: base
          jumps: 2
    - name: West Bush
      coord: [26.35, 11.95]
      data:
        flipside: Ebih Breach > In 'n Out > Northwest Ledge
      local:
        - to: West 12
          jumps: 2
        - to: East Bush
        - to: Lower Platform
    - name: West 12
      coord: [26.05, 11.7]
      local:
        - to: West Bush
      exits:
        - to: Grid 25,10-12 > East 12
          tags: [xshift]
    - name: West 13
      coord: [26.05, 12.75]
      local:
        - to: Lower Platform
          jumps: 3
        - to: West Below Platforms
      exits:
        - to: Truck Gate > East
          tags: [xshift]
    - name: West Below Platforms
      coord: [26.3, 12.75]
      local:
        - to: West 13
        - to: Garage Entry
        - to: Lower Platform
          jumps: 3
    - name: Garage Entry
      coord: [27.15, 12.8]
      data:
        flipside: Ebih Breach > In 'n Out > Southeast Plains
      local:
        - to: West Below Platforms
          jumps: 1
        - to: East Below Platforms
          jumps: 1
      exits:
        - to: Interior > Garage > Entry
          tags: [interior]
    - name: East Below Platforms
      coord: [27.6, 12.675]
      local:
        - to: East 13
          jumps: 1
        - to: East Platform
          jumps: 4
    - name: East 12
      coord: [27.95, 11.5]
      local:
        - to: East Platform

- name: Truck Gate  # MARK: Truck Gate
  on_entry: $reset_old_area(^newpos)
  data:
    portal_start: Portal Stand
    map_spot: Menu > Kiengir Map > Ebih Truck Gate
  start:
    _door_open: false
  spots:
    - name: East
      coord: [25.95, 12.75]
      local:
        - to: Switch
      exits:
        - to: By Garage > West 13
          tags: [xshift]
    - name: Switch
      coord: [25.7, 12.75]
      data:
        flipside: Ebih Breach > In 'n Out > Southwest Plains
      local:
        - to: East
      exits:
        - to: Door
          req: ^_door_open
          movement: base
        - to: Portal Stand
          req: ^_door_open
          movement: base
          jumps: 1
      actions:
        - name: Open Door
          do: ^_door_open = true
          req: not ^_door_open and $open
          tags: [hack]
    - name: Door
      coord: [25.5, 12.75]
      exits:
        - to: Portal Stand
          req: ^_door_open
          movement: base
          jumps: 1
        - to: Switch
          req: ^_door_open
          movement: base
    - name: Portal Stand
      coord: [25.325, 12.6]
      data:
        flipside: Ebih Breach > In 'n Out > Save Point
      exits:
        - to: Door
          req: ^_door_open
          movement: base
        - to: Switch
          req: ^_door_open
          movement: base
      actions:
        - name: Open Door
          req: not ^_door_open and $open and $range1
          do: ^_door_open = true
          tags: [hack]

- name: Grid 25,10-12  # MARK: Grid 25,10-12
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [25, 9, 26, 10]
    door: [25, 10, 26, 11]
    bottom: [25, 11, 26, 12]
  datamap:
    map_spot:
      flask: Menu > Kiengir Map > Ebih East Waterfall Flask
      door: Menu > Kiengir Map > Ebih East Waterfall Door
      bottom: Menu > Kiengir Map > Ebih East Waterfall Bottom
  start:
    _door_open: false
  spots:
    - name: East 12
      coord: [25.95, 11.7]
      data:
        flipside: Ebih Breach > In 'n Out > Gate East
      local:
        - to: Bush
          jumps: 1
      exits:
        - to: By Garage > West 12
          tags: [xshift]
    - name: Bush
      coord: [25.6, 11.55]
      local:
        - to: East 12
        - to: Below Bush
      exits:
        - to: Mid-Ledge
          req: $grab
          time: 1.5
    - name: West 12
      coord: [25.05, 11.8]
      local:
        - to: Below Bush
      exits:
        - to: Walled Off > East 12
          tags: [xshift]
    - name: Below Bush
      coord: [25.4, 11.8]
      local:
        - to: West 12
      exits:
        - to: Bush
          req: $grab
          time: 0.75
    - name: Mid-Ledge
      coord: [25.3, 11.1]
      local:
        - to: Door Left
          jumps: 2
        - to: Bush
        - to: Below Bush
      exits:
        - to: West 11
          req: $grab
          time: 1.5
        - to: West 11
          req: $hook
          movement: base
          jumps: 2
    - name: Door Left
      coord: [25.6, 10.75]
      local:
        - to: West 11
          jumps: 2
        - to: Bush
        - to: Below Bush
        - to: Top Platform
          jumps: 2
      exits:
        - to: Door
          req: ^_door_open
          movement: base
      actions:
        - name: Open Door
          req: $open
          do: ^_door_open = true
    - name: Top Platform
      coord: [25.4, 10.5]
      local:
        - to: Bush
          jumps_down: 2
        - to: Below Bush
          jumps_down: 2
        - to: West 11
        - to: Door Left
      exits:
        - to: West 10
          req: $grab
          time: 3.2
    - name: West 11
      coord: [25.05, 10.7]
      local:
        - to: Top Platform
          jumps: 2
        - to: Mid-Ledge
        - to: Door Left
      exits:
        - to: Waterfall > East 11
          tags: [xshift]
    - name: West 10
      coord: [25.05, 9.7]
      local:
        - to: Top Platform
        - to: Door Left
      exits:
        - to: Waterfall > East 10
          tags: [xshift]
    - name: Door
      coord: [25.8, 10.75]
      exits:
        - to: Door Left
          req: ^_door_open
          movement: base
        - to: East 11
          req: ^_door_open
          movement: base
    - name: East 11
      coord: [25.95, 10.75]
      exits:
        - to: Door
          req: ^_door_open
          movement: base
        - to: Grid 26,10-11 > West 11
          tags: [xshift]
      actions:
        - name: Open Door
          req: $open
          do: ^_door_open = true
    - name: East 10
      coord: [25.95, 9.7]
      local:
        - to: Hidden Bush
      locations:
        - name: Remote Bush
          item: Flask
          canon: Ebih Bush Flask
          req: $bs
          tags: [nearby_flask]
      exits:
        - to: Grid 26,10-11 > West 10
          tags: [xshift]
    - name: Hidden Bush
      coord: [25.85, 9.95]
      local:
        - to: East 10
          jumps: 2
      locations:
        - name: Behind Bush
          item: Flask
          canon: Ebih Bush Flask
          tags: [flask]
      exits:
        - to: East 10
          req: $grab
          time: 1
        - to: East 10
          req: $hook
          time: 0.9

- name: Waterfall  # MARK: Waterfall
  on_entry: $reset_old_area(^newpos)
  map:
    axe: [22, 10, 23, 11]
    cave: [22, 8, 23, 9]
    west9: [21, 8, 22, 9]
  datamap:
    map_spot:
      axe: Menu > Kiengir Map > Bronze Axe
      cave: Menu > Kiengir Map > Ebih Waterfall Cave
      west9: Menu > Kiengir Map > Ebih Waterfall West 9
  start:
    _west_door_open: false
    _east_door_open: false
  spots:
    - name: East 10
      coord: [24.95, 9.7]
      local: 
        - to: East Ledge
        - to: Ledge Below East Door
          jumps: 2
      exits:
        - to: Grid 25,10-12 > West 10
          tags: [xshift]
    - name: East Ledge
      coord: [24.75, 10.0]
      local:
        - to: East 10
          jumps: 1
        - to: East 11
        - to: Near East Tree
      exits:
        - to: Ledge Below East Door
          req: $hook
          movement: base
          jumps: 2
    - name: East 11
      coord: [24.95, 10.7]
      local:
        - to: Near East Tree
          jumps: 3
      exits:
        - to: Grid 25,10-12 > West 11
          tags: [xshift]
    - name: Near East Tree
      coord: [24.15, 10.15]
      local:
        - to: East 11
        - to: Waterfall Right
      exits:
        - to: East Ledge
          req: $hover
          movement: base
          jumps: 1
        - to: Ledge Below East Door
          req: $hook and $hover
          movement: base
          jumps: 3
    - name: Waterfall Right
      coord: [23.85, 10.6]
      local:
        - to: Near East Tree
          jumps: 3
        - to: Waterfall Center Right
          jumps: 2
        - to: Alcove Right
    - name: Alcove Right
      coord: [23.35, 10.75]
      local:
        - to: Waterfall Right
          jumps: 1
      locations:
        - name: Block Right
          item: Ebih_Waterfall_Block_Right
          canon: Ebih_Waterfall_Block_Right
          req: $shockwave
          price: 100
          tags: [shockwave, event]
      exits:
        - to: Alcove
          req: ^mode == 'drone' and Ebih_Waterfall_Block_Right
          movement: base
          jumps: 1
        - to: Alcove
          req: $block_clip and not Ebih_Waterfall_Block_Right
          time: 2
        - to: Waterfall Center Right  # you can't do this with ledge grab thanks to the enemy
          req: $hook
          movement: base
          jumps: 1
    - name: Waterfall Center Right
      coord: [23.25, 10.3]
      local:
        - to: Waterfall Center Center
        - to: Alcove Right
        - to: Waterfall Right
    - name: Waterfall Center Center
      coord: [23, 10.4]
      local:
        - to: Waterfall Center Right
          jumps: 1
        - to: Waterfall Center Left
          jumps: 1
      locations:
        - name: Both Blocks
          item: Ebih_Waterfall_Both_Blocks
          req: $shockwave
          price: 100
          tags: [shockwave, event]
    - name: Waterfall Center Left
      coord: [22.5, 10.5]
      local:
        - to: Waterfall Center Center
          jumps: 3
        - to: Alcove Left
        - to: Under Waterfall
        - to: Waterfall Left
          jumps: 2
        - to: Lower West Tree
          jumps: 4
    - name: Alcove Left
      coord: [22.55, 10.75]
      local:
        - to: Under Waterfall
      locations:
        - name: Block Left
          item: Ebih_Waterfall_Block_Left
          canon: Ebih_Waterfall_Block_Left
          req: $shockwave
          price: 100
          tags: [shockwave, event]
      exits:
        - to: Waterfall Center Left
          req: $grab
          time: 1.25
        - to: Waterfall Center Left
          req: $hook
          movement: base
          jumps: 1
        - to: Alcove
          req: ^mode == 'drone' and Ebih_Waterfall_Block_Left
          movement: base
          jumps: 1
        - to: Alcove
          req: $block_clip and not Ebih_Waterfall_Block_Left
          time: 2
    - name: Alcove
      coord: [22.975, 10.7]
      locations:
        - name: Pedestal
          item: Bronze_Axe
          tags: [standing]
        - name: Block Right
          item: Ebih_Waterfall_Block_Right
          canon: Ebih_Waterfall_Block_Right
          req: $shockwave
          price: 100
          tags: [shockwave, event]
        - name: Block Left
          item: Ebih_Waterfall_Block_Left
          canon: Ebih_Waterfall_Block_Left
          req: $shockwave
          price: 100
          tags: [shockwave, event]
      exits:
        - to: Alcove Left
          req: ^mode == 'drone' and Ebih_Waterfall_Block_Left
          movement: base
        - to: Alcove Right
          req: ^mode == 'drone' and Ebih_Waterfall_Block_Right
          movement: base
        - to: Alcove Right
          req: $hook and not Ebih_Waterfall_Block_Right
          time: 1.5
        - to: Alcove Left
          req: $hook and not Ebih_Waterfall_Block_Left
          time: 5  # extra difficult
    - name: Under Waterfall
      coord: [22.3, 10.8]
      exits:
        - to: Waterfall Left
          req: $grab
          movement: base
          jumps: 3
    - name: Waterfall Left
      coord: [22.0, 10.5]
      local:
        - to: Wall Right
        - to: Under Waterfall
        - to: Waterfall Center Left
        - to: Lower West Tree
          jumps: 3
    - name: Wall Right
      coord: [21.4, 10.7]
      local:
        - to: Waterfall Left
          jumps: 3
      locations:
        - name: Break Wall
          item: Ebih_Waterfall_Wall
          canon: Ebih_Waterfall_Wall
          req: $shockwave
          price: 100
          tags: [shockwave, event]
      exits:
        - to: Lower West Tree
          req: Nanite_Mist
          movement: mist1
        - to: Lower West Tree
          req: $mist2
          movement: mist2
        - to: Wall Left
          req: Ebih_Waterfall_Wall
          movement: base
      hybrid:
        - name: Break Through Wall
          to: Wall Left
          req: not Ebih_Waterfall_Wall and Nanite_Mist
          item: Ebih_Waterfall_Wall
          canon: Ebih_Waterfall_Wall
          movement: mist1
        - name: Upgraded Mist Through Wall
          to: Wall Left
          req: not Ebih_Waterfall_Wall and $mist2
          item: Ebih_Waterfall_Wall
          canon: Ebih_Waterfall_Wall
          movement: mist2
    - name: Wall Left
      coord: [21.2, 10.7]
      local:
        - to: West 11
      locations:
        - name: Break Wall
          item: Ebih_Waterfall_Wall
          canon: Ebih_Waterfall_Wall
          req: $shockwave
          price: 100
          tags: [shockwave, event]
      exits:
        - to: Wall Right
          req: Ebih_Waterfall_Wall
          movement: base
      hybrid:
        - name: Break Through Wall
          to: Wall Right
          req: not Ebih_Waterfall_Wall and Nanite_Mist
          item: Ebih_Waterfall_Wall
          canon: Ebih_Waterfall_Wall
          movement: mist1
        - name: Upgraded Mist Through Wall
          to: Wall Right
          req: not Ebih_Waterfall_Wall and $mist2
          item: Ebih_Waterfall_Wall
          canon: Ebih_Waterfall_Wall
          movement: mist2
    - name: West 11
      coord: [21.05, 10.75]
      local:
        - to: Wall Left
          jumps: 1
      exits:
        - to: Ebih West > East 11
          tags: [xshift]
    - name: Lower West Tree
      coord: [21.9, 9.95]
      local:
        - to: Wall Right
        - to: Waterfall Left
          jumps_down: 2
        - to: Under Waterfall
        - to: Waterfall Center Left
      exits:
        - to: West Lower Path
          req: $grab
          movement: base
          jumps: 2
    - name: West Lower Path
      coord: [21.7, 9.7]
      local:
        - to: West 10
        - to: Lower West Tree
        - to: Wall Right
          thru: [21.725, 10.0]
        - to: Waterfall Left
          jumps_down: 1
    - name: West 10
      coord: [21.05, 9.7]
      local:
        - to: West Lower Path
      exits:
        - to: Ebih West > East 10
          tags: [xshift]

    - name: West 9
      coord: [21.05, 8.8]
      local:
        - to: West Climb
      exits:
        - to: Ebih West > East 9
          tags: [xshift]
    - name: West Climb
      coord: [21.7, 8.8]
      local:
        - to: West 9
      exits:
        - to: Ledge Below Hole
          req: $grab
          time: 2
    - name: Ledge Below Hole
      coord: [21.65, 8.35]
      local:
        - to: West Climb
      exits:
        - to: Middle West Tree
          req: $grab
          time: 1
        - to: Middle West Tree
          req: $hook
          movement: base
          jumps: 1
        - to: Below Left Switch
          req: ^mode == 'drone'
          movement: base
          jumps: 1
        - to: West Door Right
          req: $hook
          movement: base
          jumps: 2
      actions:
        - name: Throw Drone
          req: $can_deploy
          do: $deploy_drone
          to: Ebih > Waterfall > Below Left Switch
          time: 2
    - name: Below Left Switch
      coord: [21.25, 8.2]
      local:
        - to: West 8
          jumps: 1
        - to: West Door Left
          jumps: 1
      exits:
        - to: Ledge Below Hole
          req: ^mode == 'drone'
          movement: base
      actions:
        - name: Open Door
          req: $open
          do: ^_west_door_open = true
          tags: [hack]
    - name: West 8
      coord: [21.05, 7.95]
      local:
        - to: Below Left Switch
        - to: West Door Left
      exits:
        - to: Ebih West > East 8
          tags: [xshift]
      actions:
        - name: Open Door
          req: $open
          do: ^_west_door_open = true
          tags: [hack]
    - name: West Door Left
      coord: [21.3, 7.95]
      local:
        - to: West 8
        - to: Below Left Switch
      exits:
        - to: West Door
          req: ^_west_door_open
          movement: base
    - name: West Door
      coord: [21.55, 7.95]
      exits:
        - to: West Door Left
          req: ^_west_door_open
          movement: base
        - to: West Door Right
          req: ^_west_door_open
          movement: base
    - name: West Door Right
      coord: [21.7, 7.95]
      local:
        - to: West Main Path
          jumps: 1  # TODO: double-check this is doable
        - to: Middle West Tree
        - to: Ledge Below Hole
        - to: West Climb
      exits:
        - to: West Door
          req: ^_west_door_open
          movement: base
    - name: Middle West Tree
      coord: [21.75, 8.1]
      local:
        - to: West Climb
        - to: West Door Right
          jumps: 1
      exits:
        - to: West Main Path
          req: $grab
          time: 1
        - to: West Main Path
          req: $hook
          movement: base
          jumps: 1

    - name: West Main Path
      coord: [21.9, 7.8]
      local:
        - to: Middle West Tree
        - to: West Climb
        - to: Center Main Path
          jumps: 2
        - to: Cave Entrance
    - name: Cave Entrance
      coord: [22.55, 8.35]
      local:
        - to: West Lower Path
        - to: Lower West Tree
        - to: Waterfall Center Left
        - to: Waterfall Right
        - to: Near East Tree
      exits:
        - to: Interior > Ebih Cave > Entry
          tags: [interior, cave]
        - to: Passage Exit
          req: $hook and $hover
          movement: base
    - name: Center Main Path
      coord: [22.9, 7.75]
      local:
        - to: West Main Path
        - to: Cave Entrance
        - to: Big Tree
    - name: Big Tree
      coord: [23.6, 7.9]
      local:
        - to: Center Main Path
          jumps: 2
        - to: Below Tree
        - to: Platform
    - name: Below Tree
      coord: [23.8, 8.3]
      local:
        - to: Platform
        - to: Platform by East Door
        - to: East Horizontal Door
          jumps_down: 1
      exits:
        - to: Big Tree
          req: $grab
          time: 1.2
        - to: Big Tree
          req: $hook
          movement: base
          jumps: 2
        - to: Passage Exit
          req: ^mode == 'drone'
          movement: base
    - name: Platform
      coord: [24.0, 8.3]
      local:
        - to: Below Tree
        - to: East 8
          jumps: 4
        - to: East Switch
        - to: Platform by East Door
          jumps_down: 1
        - to: East Horizontal Door
          jumps_down: 3
      exits:
        - to: Big Tree
          req: $grab
          time: 1.5
    - name: East 8
      coord: [24.95, 7.75]
      local:
        - to: Platform
      exits:
        - to: Ebih East > West 8
          tags: [xshift]
    - name: Passage Exit
      coord: [23.55, 8.55]
      local:
        - to: Lower West Tree
        - to: Alcove Right
          thru: [23.45, 10.0]
        - to: Waterfall Center Right
          thru: [23.45, 10.0]
      exits:
        - to: Below Tree
          req: ^mode == 'drone'
          movement: base
          jumps: 2

    # Waterfall Upper
    - name: East 7
      coord: [24.95, 6.75]
      local:
        - to: Top Waterfall
      exits:
        - to: Ebih East > West 7
          tags: [xshift]
    - name: Top Waterfall
      coord: [22.75, 7.0]
      local:
        - to: East 7
          jumps: 2
        - to: West 7
          jumps: 2
        - to: West Main Path
        - to: Center Main Path
    - name: West 7
      coord: [21.05, 6.75]
      local:
        - to: Top Waterfall
        - to: Cave Entrance
          thru: [22.5, 7.0]
      exits:
        - to: Ebih West > East 7
          tags: [xshift]

    # East Doors
    - name: East 9
      coord: [24.95, 8.8]
      local:
        - to: East Door Right
      exits:
        - to: Ebih East > West 9
          tags: [xshift]
    - name: East Door Right
      coord: [24.8, 8.8]
      local:
        - to: East 9
      exits:
        - to: East Door
          req: ^_east_door_open
          movement: base
      actions:
        - name: Open Door
          req: $open
          do: ^_east_door_open = true
          tags: [hack]
    - name: East Door
      coord: [24.725, 8.8]
      exits:
        - to: East Door Right
          req: ^_east_door_open
          movement: base
        - to: East Switch
          req: ^_east_door_open
          movement: base
    - name: East Switch
      coord: [24.65, 8.8]
      local:
        - to: Platform by East Door
          jumps: 1
        - to: East Horizontal Door
          jumps_down: 1
      exits:
        - to: East Door
          req: ^_east_door_open
          movement: base
      actions:
        - name: Open Door
          req: $open
          do: ^_east_door_open = true
          tags: [hack]
    - name: Platform by East Door
      coord: [24.4, 8.7]
      local:
        - to: East Switch
        - to: East Horizontal Door
          jumps_down: 2
        - to: Platform
          jumps: 3
        - to: Below Tree
          jumps: 3
      actions:
        - name: Open Door
          req: $open and $range2
          do: ^_east_door_open = true
          tags: [hack]
    - name: East Horizontal Door
      coord: [24.425, 9.05]
      local:
        - to: East Switch
          jumps: 2
        - to: Platform by East Door
          jumps: 2
        - to: Platform
          jumps: 5
        - to: Below Tree
          jumps: 5
      exits:
        - to: Ledge Below East Door
          req: ^_east_door_open
          movement: base
      actions:
        - name: Open Door
          req: $open and $range2
          do: ^_east_door_open = true
          tags: [hack]
    - name: Ledge Below East Door
      coord: [24.6, 9.45]
      local:
        - to: East 10
        - to: East Ledge
        - to: East 11
          thru: [24.65, 10.2]
        - to: Near East Tree
          thru: [24.65, 9.7]
      exits:
        - to: East Horizontal Door
          req: ^_east_door_open
          movement: base
          jumps: 2
        - to: East Horizontal Door
          req: ^_east_door_open and $hook
          movement: base
          jumps: 1
      actions:
        - name: Open Door
          req: $open and $range3
          do: ^_east_door_open = true
          tags: [hack]
          time: 0.5  # need to jump

- name: Ebih West  # MARK: Ebih West
  on_entry: $reset_old_area(^newpos)
  map:
    mid_save: [20, 9, 21, 10]
    upper_save: [20, 6, 21, 7]
    lower_save: [19, 12, 20, 13]
    tablet: [19, 9, 20, 10]
    flask: [19, 5, 20, 6]
  datamap:
    map_spot:
      mid_save: Menu > Kiengir Map > Ebih West Mid
      upper_save: Menu > Kiengir Map > Ebih West Upper
      lower_save: Menu > Kiengir Map > Ebih West Lower
      tablet: Menu > Kiengir Map > Heretic's Tablet
      flask: Menu > Kiengir Map > Ebih West Flask
  start:
    _door_open: false
  spots:
    - name: East 10
      coord: [20.95, 9.7]
      local:
        - to: Mid Save
          jumps: 2
      exits:
        - to: Waterfall > West 10
          tags: [xshift]
    - name: Mid Save
      coord: [20.5, 9.4]
      local:
        - to: East 9
          jumps: 4
        - to: Block Left
          jumps_down: 2
        - to: East 10
        - to: Alcove Entrance
        - to: Above Alcove
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Alcove Entrance
      coord: [19.85, 9.75]
      local:
        - to: Alcove
        - to: Mid Save
          jumps: 2
        - to: Block Left
      exits:
        - to: Above Alcove
          req: $grab
          time: 1
        - to: Above Alcove
          req: $hook
          movement: base
          jumps: 1
    - name: Alcove
      coord: [19.175, 9.75]
      local:
        - to: Alcove Entrance
      locations:
        - name: Tablet
          item: Heretics_Tablet
          tags: [standing]
    - name: Above Alcove
      coord: [19.6, 9.4]
      local:
        - to: Alcove Entrance
        - to: Mid Save
    - name: East 9
      coord: [20.95, 8.8]
      local:
        - to: East 10
          jumps_down: 1
        - to: Mid Save
      exits:
        - to: Waterfall > West 9
          tags: [xshift]
    - name: Block Left
      coord: [20.4, 10.1]
      locations:
        - name: Break Block
          item: Ebih_West_Block
          canon: Ebih_West_Block
          req: $shockwave
          tags: [shockwave, event]
      exits:
        - to: Mid Save
          req: $grab
          time: 2
        - to: Mid Save
          req: $hook
          movement: base
          jumps: 3
        - to: Alcove Entrance
          req: $grab
          time: 2.3
        - to: Alcove Entrance
          req: $hook
          movement: base
          jumps: 2
        - to: Block Right
          req: Ebih_West_Block
          movement: base
        # TODO: block clip
    # Upper half
    - name: East 7
      coord: [20.95, 6.75]
      local:
        - to: Above Chute
        - to: East 8
          jumps_down: 2
        - to: Middle Middle
          jumps_down: 1
      exits:
        - to: Waterfall > West 7
          tags: [xshift]
    - name: Above Chute
      coord: [20.8, 6.75]
      local:
        - to: East 7
        - to: Upper Save
          jumps: 1
        - to: Middle Middle
          jumps_down: 1
        - to: East 8
          jumps_down: 2
    - name: Upper Save
      coord: [20.5, 6.6]
      local:
        - to: Above Chute
        - to: Medium High Platform
          jumps: 2
        - to: Middle Cliff
        - to: Alcove Entrance
        - to: Above Alcove
      exits:
        - to: West Face > Lower Ledge
          req: $mist2
          movement: mist2
          penalty_tags: [yshift, -mist2.2]
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Medium High Platform
      coord: [20.3, 6.35]
      local:
        - to: Upper Save
          jumps_down: 1
        - to: High Platform
          jumps: 2
        - to: Alcove Entrance
        - to: Above Alcove
      exits:
        - to: West Face > Lower Ledge
          req: $mist2
          movement: mist2
          penalty_tags: [yshift, -mist2.2]
      actions:
        - name: Throw Drone Long
          req: $can_deploy
          do: $deploy_drone_and_move(`Ebih > Ebih West > Alcove Entrance`)
          to: Giguna > Giguna Northeast > Inner Wall
          time: 3.95
          penalty_tags: [xshift]
    - name: High Platform
      coord: [20.4, 5.975]
      local:
        - to: Medium High Platform
          jumps_down: 2
        - to: Upper Save
          jumps_down: 1
      exits:
        - to: High Ledge
          req: $grab
          movement: base
          jumps: 2
        - to: High Ledge
          req: $hook
          movement: base
          jumps: 1
        - to: Mid-air near Flask
          req: $hover
          movement: base
          jumps: 1
        - to: Highest Platform
          req: $mist2
          movement: mist2
        - to: West Face > Lower Ledge
          req: Nanite_Mist
          movement: mist1
          penalty_tags: [yshift, -mist1.2]
        - to: West Face > Lower Ledge
          req: $mist2
          movement: mist2
          penalty_tags: [yshift, -mist2.2]
    - name: High Ledge
      coord: [20.55, 5.8]
      local:
        - to: High Platform
        - to: Upper Save
        - to: East 6
          jumps: 2
        - to: Above Chute
          thru: [20.5, 6.0]
      exits:
        - to: Highest Platform
          req: $hover
          movement: base
          jumps: 1
    - name: East 6
      coord: [20.95, 5.6]
      local:
        - to: High Ledge
      exits:
        - to: Hidden Portal > West 6
          tags: [xshift]

    - name: Highest Platform
      coord: [19.7, 5.55]
      local:
        - to: Block Left
          thru: [20.0, 8.1]
        - to: Lower Save
          thru: [20.0, 8.1]
        - to: Middle Middle
        - to: Medium High Platform
        - to: Alcove Entrance
          jumps_down: 1
      locations:
        - name: Flask
          canon: Ebih_West_Flask
          item: Flask
          tags: [flask]
        - name: Shockwave Flask
          canon: Ebih_West_Flask
          item: Flask
          req: $shockwave
          price: 100
          tags: [shockwave]
        - name: Flask Collection Skip
          canon: Ebih_West_Flask
          item: Flask
          to: Menu > Warp Only > Kiengir
          req: $melee_cskip
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Ebih_West_Flask
          item: Flask
          to: ^map_spot
          req: $melee_cskip and Fast_Travel
          tags: [cskip]
      exits:
        - to: High Ledge
          req: $hover
          movement: base
        - to: Giguna > Giguna Northeast > Inner Wall
          movement: base
          penalty_tags: [xshift, -base.1]
        - to: West Face > Lower Ledge
          req: Nanite_Mist
          movement: mist1
          penalty_tags: [yshift, -mist1.2]
        - to: West Face > Lower Ledge
          req: $mist2
          movement: mist2
          penalty_tags: [yshift, -mist2.2]
    - name: Mid-air near Flask
      coord: [19.9, 5.8]
      local:
        - to: Giguna Pillar
      exits:
        - to: Highest Platform
          req: Nanite_Mist
          movement: mist1
        - to: Highest Platform
          req: $mist2
          movement: mist2
        - to: Giguna > Giguna Northeast > Inner Wall
          req: $hover
          movement: base
          penalty_tags: [xshift, -base.1]
    - name: High Above Flask
      coord: [19.9, 5.1]
      local:
        - to: Highest Platform
    - name: Above the Trees
      coord: [20.4, 5.1]
      local:
        - to: Mid-air near Flask
        - to: Middle Middle
          thru: [20.2, 7.0]
        - to: Block Left
          thru: [20.0, 8.1]
        - to: Mid Save
          thru: [20.0, 8.1]
        - to: Alcove Entrance
      exits:
        - to: High Above Flask
          req: $hover
          movement: base
        - to: High Above Flask
          req: Nanite_Mist
          movement: mist1
        - to: High Above Flask
          req: $mist2
          movement: mist2
    - name: Middle North
      coord: [20.05, 5.1]
      local:
        - to: East 6
        - to: Upper Save
        - to: Above Chute
          thru: [20.5, 6.0]

    # Middle-ish
    - name: East 8
      coord: [20.95, 7.95]
      local:
        - to: Middle Middle
          jumps: 1
      exits:
        - to: Waterfall > West 8
          tags: [xshift]
    - name: Middle Middle
      coord: [20.65, 7.8]
      local:
        - to: East 8
        - to: Middle Cliff
      exits:
        - to: East 7
          req: $grab or $climb
          time: 3.5
        - to: East 7
          req: $hook
          movement: base
          jumps: 4
        - to: Above Chute
          req: $grab or $climb
          time: 3.5
        - to: Above Chute
          req: $hook
          movement: base
          jumps: 4
    - name: Middle Cliff
      coord: [20.05, 8.0]
      local:
        - to: Middle Middle
          jumps: 2
        - to: Alcove Entrance
        - to: Above Alcove

    - name: Giguna Pillar
      coord: [19.3, 8.4]
      local:
        - to: Above Alcove
      exits:
        - to: Giguna > Giguna Northeast > Inner Wall
          time: 3.3
    - name: West 9
      coord: [19.05, 8.75]
      exits:
        - to: Giguna > Giguna Northeast > East 9
          tags: [xshift]
        - to: Giguna Pillar
          req: $grab or $climb

    # Below block
    - name: Block Right
      coord: [20.65, 10.1]
      local:
        - to: Refill Station
        - to: East 11
      locations:
        - name: Break Block
          item: Ebih_West_Block
          canon: Ebih_West_Block
          req: $shockwave
          tags: [shockwave, event]
      exits:
        - to: Block Left
          req: Ebih_West_Block
          movement: base
    - name: Refill Station
      coord: [20.7, 10.8]
      local:
        - to: Above Door
        - to: East 11
          jumps: 1
        - to: Small Gap
      # TODO: energy refills? advanced drone deploy
      keep: true
    - name: East 11
      coord: [20.95, 10.75]
      local:
        - to: Refill Station
      exits:
        - to: Waterfall > West 11
          tags: [xshift]
    - name: Above Door
      coord: [20.55, 10.9]
      exits:
        - to: Small Gap
          req: not ^_door_open
          movement: base
          jumps: 1
        - to: Refill Station
          req: not ^_door_open or $grab
          movement: base
          jumps: 1
        - to: Below Door
          req: ^_door_open
          movement: base
    - name: Below Door
      coord: [20.55, 11.4]
      local:
        - to: Left of Switch
      actions:
        - name: Open Door
          req: $open
          do: ^_door_open = true; IF (^indra WITHIN `Ebih > Ebih West > Above Door`) { ^indra = `Ebih > Ebih West > Below Door`; }
          tags: [hack]
      exits:
        - to: Above Door
          req: $grab and ^_door_open
          movement: base
          jumps: 3
        - to: Refill Station
          req: $hook and ^_door_open
          time: 1  # ?
    - name: Small Gap
      coord: [20.45, 10.8]
      local:
        - to: Above Door
        - to: Refill Station
      exits:
        - to: Left of Gap
          req: ^mode == 'drone'
          movement: base
    - name: Left of Gap
      coord: [20.1, 10.8]
      local:
        - to: Left of Switch
          thru: [20.05, 11.1]
        - to: Lower Hill
      exits:
        - to: Small Gap
          req: ^mode == 'drone'
          movement: base
    - name: Left of Switch
      coord: [20.2, 11.6]
      local:
        - to: Lower Hill
          jumps: 2
        - to: Below Door
          jumps: 1
      actions:
        - name: Open Door
          req: Infect
          do: ^_door_open = true; IF (^indra WITHIN `Ebih > Ebih West > Above Door`) { ^indra = `Ebih > Ebih West > Below Door`; }
          tags: [hack]
    - name: Lower Hill
      coord: [20.0, 11.3]
      local:
        - to: Left of Switch
        - to: Lower Cliff
      exits:
        - to: Left of Gap
          req: $hook
    - name: Lower Cliff
      coord: [19.7, 11.6]
      local:
        - to: Lower Hill
          jumps: 2
        - to: Lower Platform
    - name: Lower Platform
      coord: [19.6, 12.4]
      local:
        - to: Lower Save
        - to: East 13
        - to: West 13
      exits:
        - to: Lower Cliff
          req: $grab
          movement: base
          jumps: 6  # ?
    - name: Lower Save
      coord: [19.5, 12.65]
      local:
        - to: Lower Platform
          jumps: 2
        - to: East 13
        - to: West 13
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: West High Cliff
      coord: [19.6, 10.85]
      local:
        - to: Lower Hill
        - to: Lower Cliff
        - to: West Fork
    - name: West Fork
      coord: [19.35, 11.0]
      local:
        - to: West High Cliff
          jumps: 1
        - to: West 11
          jumps: 2
        - to: West 12
    - name: West 11
      coord: [19.05, 10.75]
      local:
        - to: West Fork
      exits:
        - to: Giguna > Giguna Northeast > East 11
          tags: [xshift]
    - name: West 12
      coord: [19.05, 11.8]
      exits:
        - to: West Fork
          req: $climb
          movement: base
          jumps: 8  # ?
        - to: Giguna > Wasteland > East 12
          tags: [xshift]
    - name: West 13
      coord: [19.05, 12.7]
      local:
        - to: Lower Save
          jumps: 1
      exits:
        - to: Giguna > Wasteland > East 13
          tags: [xshift]
    - name: East 13
      coord: [20.95, 12.75]
      local:
        - to: Lower Save
          jumps: 1
      exits:
        - to: Vertical Interchange > West 13
          tags: [xshift]

- name: Ebih East  # MARK: Ebih East
  on_entry: $reset_old_area(^newpos)
  map:
    dispenser: [25, 8, 26, 9]
    urn: [26, 8, 27, 9]
    note: [26, 7, 27, 8]
  datamap:
    map_spot:
      dispenser: Menu > Kiengir Map > Ebih East Health
      urn: Menu > Kiengir Map > Infect
      note: Menu > Kiengir Map > Under Siege
  reset:
    _platform1_moved: false
    _platform2_moved: false
  spots:
    - name: West 8
      coord: [25.05, 7.75]
      local:
        - to: Moving Platform
      exits:
        - to: Waterfall > East 8
          tags: [xshift]
    - name: Moving Platform
      coord: [25.35, 7.75]
      local:
        - to: West 8
        - to: Ledge End
      exits:
        - to: East Ledge
          req: $hover
          movement: base
          jumps: 1
      actions:
        # Indra's much faster, so we won't add an action that waits till the end
        # just to get to East Ledge first
        - name: Activate Ride
          req: Infect and $grab and not ^_platform1_moved
          do: ^_platform1_moved = true
          to: Ebih > Ebih East > Middle Platform
          time: 3.7
    - name: Ledge End
      coord: [26, 8.0]
      local:
        - to: Moving Platform
          jumps: 2
        - to: Lower Moving Platform
        - to: Corner
      exits:
        - to: East Ledge
          req: $hook
          movement: base
          jumps: 2
    - name: Lower Moving Platform
      coord: [26.15, 8.7]
      local:
        - to: Corner
        - to: Dispenser
          thru: [26.8, 8.5]
          jumps: [1, 0]
      locations:
        - name: Remote Urn
          item: Infect
          canon: Infect
          req: Boomerang
          tags: [nearby_urn]
      actions:
        - name: Activate Ride
          req: Infect and not ^_platform2_moved
          do: ^_platform2_moved = true
          to: Ebih > Ebih East > Dispenser
          time: 4.5
        - name: Activate Lift
          req: Infect and $grab and not ^_platform2_moved
          do: ^_platform2_moved = true
          to: Ebih > Ebih East > Ledge End
    - name: Corner
      coord: [26.4, 8.8]
      local:
        - to: Lower Moving Platform
          jumps: 1
      locations:
        - name: Urn
          item: Infect
          canon: Infect
          tags: [urn]
    - name: Dispenser
      coord: [25.5, 8.8]
      local:
        - to: Wall East
          jumps: 1
      locations:
        - name: Vend
          item: Health_Fragment
          req: Infect
          time: 3.5
      exits:
        - to: Lower Center Pillar
          req: $hook
          movement: base
          jumps: 2
        - to: Lower Center Pillar
          req: $grab
          movement: base
          jumps: 3
      actions:
        - name: Activate Lift
          req: Infect and ^_platform2_moved and ($grab or $hook)
          do: ^_platform2_moved = false
          to: Ebih > Ebih East > Ledge End
          time: 5
    - name: Wall East
      coord: [25.4, 8.75]
      local:
        - to: Dispenser
      locations:
        - name: Break Wall
          canon: Ebih_East_Wall
          item: Ebih_East_Wall
          req: $shockwave
          price: 100
          tags: [shockwave]
      exits:
        - to: Wall West
          req: Ebih_East_Wall
          movement: base
      hybrid:
        - name: Break Through Wall
          canon: Ebih_East_Wall
          item: Ebih_East_Wall
          to: Wall West
          req: Nanite_Mist
          movement: mist1
        - name: Break Through Wall Faster
          canon: Ebih_East_Wall
          item: Ebih_East_Wall
          to: Wall West
          req: $mist2
          movement: mist2
    - name: Wall West
      coord: [25.225, 8.75]
      local:
        - to: West 9
      locations:
        - name: Break Wall
          canon: Ebih_East_Wall
          item: Ebih_East_Wall
          req: $shockwave
          price: 100
          tags: [shockwave]
      exits:
        - to: Wall East
          req: Ebih_East_Wall
          movement: base
      hybrid:
        - name: Break Through Wall
          canon: Ebih_East_Wall
          item: Ebih_East_Wall
          to: Wall East
          req: Nanite_Mist
          movement: mist1
        - name: Break Through Wall Faster
          canon: Ebih_East_Wall
          item: Ebih_East_Wall
          to: Wall East
          req: $mist2
          movement: mist2
    - name: West 9
      coord: [25.05, 8.8]
      local:
        - to: Wall West
          jumps: 1
      exits:
        - to: Waterfall > East 9
          tags: [xshift]
    - name: Lower Center Pillar
      coord: [25.9, 8.4]
      local:
        - to: Dispenser
      exits:
        - to: Lower Moving Platform
          req: not ^_platform2_moved
          movement: base
        - to: Ledge End
          req: $hook
          movement: base
          jumps: 2
        - to: East Ledge
          req: $hook
          movement: base
          jumps: 3

    - name: East Ledge
      coord: [26.1, 7.6]
      local:
        - to: Moving Platform
        - to: Middle Platform
          jumps: 2
        - to: Ledge End
        - to: Lower Moving Platform
        - to: East Hill
          jumps: 1
      locations:
        - name: Note
          item: Under_Siege
          tags: [standing]
    - name: Middle Platform
      coord: [25.85, 7.3]
      local:
        - to: Upper Ledge
          jumps: 4
        - to: East Ledge
          jumps_down: 2
        - to: Moving Platform
        - to: Lower Moving Platform
        - to: East Hill
    - name: Upper Ledge
      coord: [25.4, 6.75]
      local:
        - to: West 7
        - to: West 8
        - to: Moving Platform
        - to: Ledge End
        - to: Middle Platform
    - name: West 7
      coord: [25.05, 6.75]
      local:
        - to: Upper Ledge
      exits:
        - to: Waterfall > East 7
          tags: [xshift]

    - name: East Hill
      coord: [26.5, 7.55]
      local:
        - to: Middle Platform
          jumps: 2
        - to: East Ledge
        - to: East 9
    - name: East 9
      coord: [26.95, 8.3]
      exits:
        - to: East Hill
          req: $grab or $climb
          time: 2
        - to: Observation Tower Room > West 9
          tags: [xshift]
    - name: East Mid-air
      coord: [26.95, 7.4]
      exits:
        - to: Observation Tower Room > West Mid-air
          tags: [xshift]
    - name: North
      coord: [26.2, 6.1]
      local:
        - to: Moving Platform
        - to: Ledge End
          jumps_down: 1
        - to: East Ledge
          jumps_down: 1
        - to: Middle Platform
        - to: Upper Ledge
        - to: East Hill
        - to: East 9

- name: Hidden Portal  # MARK: Hidden Portal
  on_entry: $reset_old_area(^newpos)
  data:
    save_point: Save Point
    portal_start: Portal Stand
    portal_hidden: true
  map:
    save: [21, 2, 22, 3]
    button: [21, 4, 22, 5]
    portal: [21, 5, 22, 6]
  datamap:
    map_spot:
      save: Menu > Kiengir Map > Ebih Observatory
      button: Menu > Kiengir Map > Ebih Hidden Portal Button
      portal: Menu > Kiengir Map > Ebih Hidden Portal Portal
  spots:
    - name: West 6
      coord: [21.05, 5.6]
      local:
        - to: Portal Stand
        - to: Lowest Stair
          jumps: 1
      exits:
        - to: Ebih West > East 6
          tags: [xshift]
    - name: Portal Stand
      coord: [21.475, 5.7]
      local:
        - to: West 6
          jumps: 1
        - to: East 6
        - to: Lowest Stair
          jumps: 1
    - name: East 6
      coord: [21.95, 5.7]
      local:
        - to: Portal Stand
      exits:
        - to: Boss Room > West 6
          tags: [xshift]

    - name: Lowest Stair
      coord: [21.4, 5.55]
      local:
        - to: West 6
        - to: Portal Stand
        - to: East 6
        - to: Stair Below Gate
          jumps: 6
    - name: Stair Below Gate
      coord: [21.45, 4.75]
      local:
        - to: West 6
          jumps_down: 1
        - to: East 6
        - to: Portal Stand
          jumps_down: 3
      exits:
        - to: Gate Ledge East
          req: Ebih_Hidden_Portal_Gate
          movement: base
          jumps: 3
        - to: Gate Ledge West
          req: $grab and Ebih_Hidden_Portal_Gate
          movement: base
          jumps: 4
        - to: Gate Ledge West
          req: $hook and Ebih_Hidden_Portal_Gate
          movement: base
          jumps: 2

    - name: East 5
      coord: [21.95, 4.3]
      local:
        - to: Button
          jumps: 1
      locations:
        - name: Boomerang Button
          req: $boomerang
          canon: Ebih_Hidden_Portal_Gate
          item: Ebih_Hidden_Portal_Gate
          time: .25  # Can't leave the room until it hits, if you move toward the button you just hit it
      exits:
        - to: Boss Room > West 5
          tags: [xshift]
    - name: Button
      coord: [21.75, 4.2]
      local:
        - to: East 5
        - to: Gate Ledge East
          jumps: 2
      locations:
        - name: Hit Button
          req: $can_damage
          canon: Ebih_Hidden_Portal_Gate
          item: Ebih_Hidden_Portal_Gate
          tags: [button]
    - name: Gate Ledge East
      coord: [21.45, 4.15]
      local:
        - to: Button
          jumps: 1
        - to: Gate Ledge West
          jumps: 1
      locations:
        - name: Remote Button
          req: $boomerang
          canon: Ebih_Hidden_Portal_Gate
          item: Ebih_Hidden_Portal_Gate
          tags: [button]
      exits:
        - to: Stair Below Gate
          req: Ebih_Hidden_Portal_Gate
          movement: base
    - name: Gate Ledge West
      coord: [21.3, 4.05]
      local:
        - to: Gate Ledge East
        - to: Stair Above Gate
          jumps: 3
      exits:
        - to: Stair Below Gate
          req: Ebih_Hidden_Portal_Gate
          movement: base

    - name: Stair Above Gate
      coord: [21.2, 3.6]
      local:
        - to: Gate Ledge West
        - to: Gate Ledge East
        - to: Button
        - to: Save Ledge
          jumps: 6
      exits:
        - to: Stair Below Gate
          req: Ebih_Hidden_Portal_Gate
          movement: base
        - to: Save Ledge
          req: $hook
          movement: base
          jumps: 5
    - name: Save Ledge
      coord: [21.35, 2.8]
      local:
        - to: Stair Above Gate
        - to: Gate Ledge West
        - to: Gate Ledge East
        - to: Button
          thru: [21.325, 3.05]
        - to: Save Point
          jumps: 1
      exits:
        - to: Stair Below Gate
          req: Ebih_Hidden_Portal_Gate
          movement: base
        - to: High Ledge
          req: Nanite_Mist
          movement: mist1
        - to: High Ledge
          req: $mist2
          movement: mist2
    - name: Save Point
      coord: [21.5, 2.7]
      local:
        - to: Save Ledge
        - to: Tunnel Entrance
        - to: Upper Slope
          jumps: 2
      exits:
        - to: High Ledge
          req: Nanite_Mist
          movement: mist1
        - to: High Ledge
          req: $mist2
          movement: mist2
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Tunnel Entrance
      coord: [21.7, 2.8]
      local:
        - to: Save Point
          jumps: 1
        - to: Upper Slope
          jumps: 2
      exits:
        - to: Peak > Tunnel Entrance
          req: ^mode == 'drone'
          movement: base
          penalty_tags: [xshift, -base.1]
    - name: Upper Slope
      coord: [21.8, 2.55]
      local:
        - to: Save Point
        - to: Tunnel Entrance
        - to: East 3
          jumps: 1
      exits:
        - to: High Ledge
          req: $infinite_climb
          movement: base
          jumps: 3
        - to: Peak > Observatory West
          req: $hook and $hover
          movement: fast_hover
          jumps: 1
          penalty_tags: [xshift, -fast_hover.1]
    - name: East 3
      coord: [21.95, 2.4]
      local:
        - to: Upper Slope
      exits:
        - to: High Ledge
          req: $hover
          movement: base
          jumps: 2
        - to: High Ledge
          req: Nanite_Mist
          movement: mist1
        - to: High Ledge
          req: $mist2
          movement: mist2
        - to: Peak > West 3
          tags: [xshift]
    - name: High Ledge
      coord: [21.2, 2.1]
      local:
        - to: West 3
        - to: Save Ledge
        - to: Save Point
        - to: Tunnel Entrance
        - to: Gate Ledge East
        - to: Button
          thru: [21.325, 4.05]
      exits:
        - to: East 3
          req: $hover
          movement: base
        - to: Upper Slope
          req: $hover
          movement: base
        - to: Stair Below Gate
          req: Ebih_Hidden_Portal_Gate
          movement: base
    - name: West 3
      coord: [21.05, 2.2]
      local:
        - to: High Ledge
          jumps: 1
      exits:
        - to: West Face > East
          tags: [xshift]
        - to: Save Point
          req: $hook
          movement: fast_hover
          jumps: 1
        - to: Tunnel Entrance
          req: $hook
          movement: fast_hover
          jumps: 1
        - to: Peak > Observatory West
          req: $hook and $hover
          movement: fast_hover
          jumps: 1
          penalty_tags: [xshift, -fast_hover.1]

- name: West Face  # MARK: West Face
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [20, 4, 21, 5]
  datamap:
    map_spot:
      flask: Menu > Kiengir Map > Ebih West Face Flask
  spots:
    - name: East
      coord: [20.95, 2.2]
      local:
        - to: Upper Ledge
      exits:
        - to: Hidden Portal > West 3
          tags: [xshift]
    - name: Upper Ledge
      coord: [20.85, 2.2]
      local:
        - to: East
        - to: Lower Ledge
    - name: Lower Ledge
      coord: [20.3, 4.3]
      local:
        - to: Southwest
        - to: South
          thru: [20.3, 4.6]
      locations:
        - name: Flask
          canon: Ebih_West_Face_Flask
          item: Big_Flask
          tags: [flask]
        - name: Shockwave Flask
          canon: Ebih_West_Face_Flask
          item: Big_Flask
          req: $shockwave
          price: 100
          tags: [shockwave]
      exits:
        - to: Upper Ledge
          req: Nanite_Mist
          movement: mist1
        - to: Upper Ledge
          req: $mist2
          movement: mist2
      hybrid:
        - name: Flask Collection Skip
          canon: Ebih_West_Face_Flask
          item: Big_Flask
          to: Menu > Warp Only > Kiengir
          req: $melee_cskip
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Ebih_West_Face_Flask
          item: Big_Flask
          to: ^map_spot
          req: $melee_cskip and Fast_Travel
          tags: [cskip]
    - name: Southwest
      coord: [20.05, 4.9]
      exits:
        - to: Ebih West > Middle North
          tags: [yshift]
    - name: South
      coord: [20.4, 4.9]
      exits:
        - to: Ebih West > Above the Trees
          tags: [yshift]

- name: Boss Room  # MARK: Boss Room
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [22, 4, 23, 5]
    health: [23, 4, 24, 5]
  datamap:
    map_spot:
      flask: Menu > Kiengir Map > Ebih Alu Flask
      health: Menu > Kiengir Map > Ebih Alu Health
  spots:
    - name: West 6
      coord: [22.05, 5.7]
      local:
        - to: Boss
          jumps: 4
        - to: Past Boss
      exits:
        - to: Hidden Portal > East 6
          tags: [xshift]
    - name: Boss
      coord: [22.8, 4.9]
      local:
        - to: West 6
          jumps_down: 1
        - to: Past Boss
        - to: Lower Tree
      locations:
        - name: Hack Alu
          item: Ebih_Alu
          canon: Ebih_Alu
          req: $overheat and $can_damage
          price: 280  # Overheat (100) x2 + Overload (80)
          time: 25  # can be split across fetching the health node, too
        - name: Fight Alu
          item: Ebih_Alu
          canon: Ebih_Alu
          req: $can_damage
          time: 50  # an estimate... includes risk of taking too much damage, I guess?
        - name: Boss Reward
          item: Flask
          req: Ebih_Alu
          tags: [flask]

    - name: Past Boss
      coord: [23.1, 5.7]
      local:
        - to: West 6
        - to: Boss
          jumps: 4
        - to: Lower Tree
          jumps: 2
    - name: Lower Tree
      coord: [23.5, 5.25]
      local:
        - to: Past Boss
        - to: Boss
          jumps: 4
      exits:
        - to: Lower Ledge
          req: $grab
          time: 1
        - to: Lower Ledge
          req: $hook
          movement: base
          jumps: 1
    - name: Lower Ledge
      coord: [23.7, 5.0]
      local:
        - to: Lower Tree
        - to: East 6
      exits:
        - to: Upper Tree
          req: $hover and $hook
          movement: base
          jumps: 2
    - name: East 6
      coord: [23.95, 5.0]
      local:
        - to: Lower Ledge
      exits:
        - to: Drone Room > West 6
    - name: East 4
      coord: [23.95, 3.8]
      local:
        - to: Upper Tree
        - to: High Platform
      exits:
        - to: Drone Room > West 4
    - name: East Ledge
      coord: [23.85, 4.5]
      local:
        - to: Upper Tree
          jumps: 1
        - to: Lower Ledge
      locations:
        - name: Item
          item: Health_Node
          tags: [standing]
    - name: Upper Tree
      coord: [23.55, 4.5]
      local:
        - to: High Platform
          jumps: 2
        - to: Boss
        - to: Past Boss
        - to: Lower Tree
          jumps_down: 1
        - to: East Ledge
    - name: High Platform
      coord: [23.1, 4.1]
      local:
        - to: West 5
          jumps: 2
        - to: Boss  # TODO: Add another Boss fight spot at a higher elevation
          jumps_down: 2
        - to: Upper Tree
      exits:
        - to: East 4
          req: $hover and $hook
          movement: base
          jumps: 1
    - name: West 5
      coord: [22.05, 4.3]
      local:
        - to: West 6
          jumps_down: 1
        - to: Boss
        - to: High Platform
          jumps: 2
      exits:
        - to: Hidden Portal > East 5
          tags: [xshift]

- name: Drone Room  # MARK: Drone Room
  on_entry: $reset_old_area(^newpos)
  reset:
    _platform_moved: false
  data:
    portal_start: Portal
  map:
    urn: [24, 5, 25, 6]
  datamap:
    map_spot:
      urn: Menu > Kiengir Map > Remote Drone
  spots:
    - name: West 6
      coord: [24.05, 5.0]
      local:
        - to: Pit Left
        - to: Middle Platform
      exits:
        - to: Boss Room > East 6
          tags: [xshift]
    - name: West 4
      coord: [24.05, 3.75]
      local:
        - to: Left Platform
        - to: Middle Platform
          jumps_down: 1
        - to: West 6
          thru: [24.25, 4.7]
          jumps_down: [1, 0]
        - to: Pit Left
          thru: [24.25, 4.7]
      exits:
        - to: Boss Room > East 4
          tags: [xshift]
    - name: Pit Left
      coord: [24.2, 5.4]
      data:
        flipside: Ebih Breach > Portals 101 > West Lower Ledge
      local:
        - to: Portal
      exits:
        - to: West 6
          req: $climb
          movement: base
          jumps: 2
        - to: West 6
          req: $hook
          movement: base
          jumps: 1
        - to: Middle Platform
          req: $climb
          movement: base
          jumps: 2
        - to: Middle Platform
          req: $hook
          movement: base
          jumps: 2
      actions:
        - name: Activate Lift
          req: Infect and ^_platform_moved
          do: ^_platform_moved = false
          to: Ebih > Drone Room > Moving Platform
          time: 7
        - name: Activate Lift But Get Off Early
          req: Infect and ^_platform_moved
          do: ^_platform_moved = false
          to: Ebih > Drone Room > West 6
          time: 1.4
    - name: Portal
      coord: [24.525, 5.6]
      data:
        flipside: Ebih Breach > Portals 101 > Save Point
      local:
        - to: Pit Left
          jumps: 2
        - to: Item
    - name: Item
      coord: [24.7, 5.7]
      local:
        - to: Portal
          jumps: 1
      locations:
        - name: Urn
          item: Remote_Drone
          canon: Remote_Drone
          tags: [urn]
      hybrid:
        - name: Urn Collection Skip
          item: Remote_Drone
          canon: Remote_Drone
          to: Menu > Warp Only > Kiengir
          tags: [cskip]
        - name: Urn Fast Travel
          item: Remote_Drone
          canon: Remote_Drone
          req: Fast_Travel
          to: Menu > Kiengir Map > Remote Drone
          tags: [cskip]
    - name: Middle Platform
      coord: [24.4, 5.1]
      local:
        - to: West 6
          jumps: 1
        - to: Pit Left
          jumps_down: 1
        - to: Portal
          jumps_down: 1
        - to: Item
          jumps_down: 1
      exits:
        - to: Portal Exit
          req: $grab
          time: 2.5
      hybrid:
        - name: Urn Quick Grab
          item: Remote_Drone
          canon: Remote_Drone
          to: Portal
          req: Boomerang
          time: 1
          item_tags: [nearby_urn]
    - name: Portal Exit
      coord: [24.525, 4.425]
      local:
        - to: West 6
          thru: [24.25, 4.7]
        - to: Left Platform
          thru: [24.15, 4.35]
          jumps: [2, 2]
        - to: Middle Platform
          thru: [24.25, 4.7]
        - to: Tree
      actions:
        - name: Activate Platform
          req: Infect and not ^_platform_moved
          do: ^_platform_moved = true
          # Takes about 1 second to perform, then ~6.5 to reach the useful point below
          # (not counting the urn pickup time!)
          # I have to wait maybe 2-3 seconds total if getting Drone after this
          # if the drone is retrieving it for indra, would probably involve more waiting
          time: 4
      exits:
        # double-activate the platform to get on top of it?
        - to: Moving Platform
          req: Infect and not ^_platform_moved
          time: 5
        - to: Moving Platform
          req: $hook and not ^_platform_moved
          movement: base
          jumps: 2
        # It might be possible to get to the East 4 spot as drone with mist float
    - name: Moving Platform
      coord: [24.5, 4.0]
      local:
        - to: Left Platform
        - to: Portal Exit
        - to: Tree
        - to: West 6
        - to: Pit Left
      actions:
        - name: Throw Drone
          req: $can_deploy
          do: $deploy_drone_and_move(`Ebih > Drone Room > Tree`)
          to: Ebih > Drone Room > East 4
          time: 1.5
    - name: Left Platform
      coord: [24.3, 4.0]
      local:
        - to: West 4
          jumps: 1
        - to: Pit Left
          jumps_down: 1
        - to: West 6
          thru: [24.25, 4.7]
          jumps_down: [1, 0]
        - to: Middle Platform
          thru: [24.25, 4.7]
          jumps_down: [1, 0]
    - name: Tree
      coord: [24.7, 4.6]
      local:
        - to: Portal Exit
          jumps: 1
    - name: East 4
      coord: [24.95, 3.75]
      local:
        - to: Moving Platform
        - to: Portal Exit
        - to: Tree
      exits:
        - to: Drone Pit > West 4
          req: ^mode == 'drone'
          tags: [xshift]

- name: Peak  # MARK: Peak
  on_entry: $reset_old_area(^newpos)
  data:
    portal_start: Portal Stand
  map:
    west: [22, 2, 23, 3]
    center: [23, 2, 24, 3]
    portal: [24, 2, 25, 3]
  datamap:
    map_spot:
      west: Menu > Kiengir Map > Ebih Peak West
      center: Menu > Kiengir Map > Ebih Peak Center
      portal: Menu > Kiengir Map > Ebih Peak Portal
  spots:
    - name: West 3
      coord: [22.05, 2.4]
      local:
        - to: Observatory West
      exits:
        - to: Hidden Portal > East 3
          tags: [xshift]
    - name: Observatory West
      coord: [22.475, 2.55]
      local:
        - to: West 3
          jumps: 1
        - to: Observatory East
          jumps: 1
      exits:
        - to: Interior > Observatory > West
          tags: [interior]
    - name: Observatory East
      coord: [23.75, 2.55]
      local:
        - to: Observatory West
      exits:
        - to: Interior > Observatory > East
          tags: [interior]
        - to: Middle Ledge
          req: $hook
          movement: base
          jumps: 1
        - to: Middle Ledge
          req: $climb or ($grab and Anuman)
          movement: base
          jumps: 2
    - name: Middle Ledge
      coord: [23.95, 2.15]
      local:
        - to: Observatory West
        - to: Observatory East
        - to: Tunnel Ledge
        - to: Portal Stand
      exits:
        - to: East 3
          req: $hover
          movement: base
          jumps: 1
    - name: Tunnel Ledge
      coord: [24.15, 2.45]
      local:
        - to: Middle Ledge
          jumps: 2
        - to: Tunnel Entrance
        - to: Portal Stand
    - name: Tunnel Entrance
      coord: [24.175, 2.85]
      local:
        - to: Tunnel Ledge
          thru: [24.25, 2.7]
          jumps: [1, 1]
        - to: Portal Stand
          thru: [24.25, 2.7]
          jumps: [1, 1]
      exits:
        - to: Hidden Portal > Tunnel Entrance
          req: ^mode == 'drone'
          movement: base
          jumps: 1
          penalty_tags: [xshift, -base.1]
        - to: Tunnel Ledge
          req: $hook
          movement: base
          jumps: 2
        - to: Portal Stand
          req: $hook
          movement: fast_hover
          jumps: 2
        - to: Tunnel Ledge
          req: $climb or ($grab and Anuman)
          movement: base
          jumps: 2
    - name: Portal Stand
      coord: [24.525, 2.6]
      local:
        - to: Tunnel Ledge
          thru: [24.25, 2.7]
          jumps: [0, 1]
        - to: Tunnel Entrance
          thru: [24.25, 2.7]
        - to: East Slope
          jumps: 2
      exits:
        - to: Tunnel Ledge
          req: $hover
          movement: base
          jumps: 1
        - to: East Slope
          req: $hover
          movement: base
          jumps: 1
        - to: East 3
          req: $hook and $hover
          movement: base
          jumps: 2
    - name: East Slope
      coord: [24.85, 2.5]
      local:
        - to: Portal Stand
      exits:
        - to: East 3
          req: $hook
          movement: base
          jumps: 2
        - to: East 3
          req: $climb or ($grab and Anuman)
          movement: base
          jumps: 2
    - name: East 3
      coord: [24.95, 2.05]
      local:
        - to: Portal Stand
        - to: East Slope
      exits:
        - to: Middle Ledge
          req: $hover
          movement: base
        - to: Drone Pit > West 3
          tags: [xshift]

- name: Drone Pit  # MARK: Drone Pit
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [25, 5, 26, 6]
    high: [25, 1, 26, 2]
  datamap:
    map_spot:
      flask: Menu > Kiengir Map > Ebih Drone Pit Flask
      high: Menu > Kiengir Map > Ebih High Flask
  spots:
    - name: West 4
      coord: [25.05, 3.75]
      exits:
        - to: Pit
          req: ^mode == 'drone'
          time: 6.25
        - to: Drone Room > East 4
          req: ^mode == 'drone'
          tags: [xshift]
    - name: Pit
      coord: [25.3, 5.7]
      locations:
        - name: Item
          canon: Ebih_Drone_Pit_Flask
          item: Flask
          tags: [flask]
        - name: Shockwave Flask
          canon: Ebih_Drone_Pit_Flask
          item: Flask
          req: $shockwave
          price: 100
          tags: [shockwave]
      exits:
        - to: First Rocks
          req: $hook
          movement: base
          jumps: 2
      hybrid:
        - name: Flask Collection Skip
          canon: Ebih_Drone_Pit_Flask
          item: Flask
          to: Menu > Warp Only > Kiengir
          req: $melee_cskip
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Ebih_Drone_Pit_Flask
          item: Flask
          to: ^map_spot
          req: $melee_cskip and Fast_Travel
          tags: [cskip]
    - name: Bush Left
      coord: [25.2, 5.7]
      data:
        flipside: Ebih Breach > Drone Tutorial > Bottom
      local:
        - to: Pit
      locations:
        - name: Item
          canon: Ebih_Drone_Pit_Flask
          item: Flask
          tags: [flask]
        - name: Shockwave Flask
          canon: Ebih_Drone_Pit_Flask
          item: Flask
          req: $shockwave
          price: 100
          tags: [shockwave]
      exits:
        - to: First Rocks
          req: $hook
          movement: base
          jumps: 2
    - name: First Rocks
      coord: [25.45, 5.2]
      data:
        flipside: Ebih Breach > Drone Tutorial > First Rocks
      local:
        - to: Pit
        - to: Bush Left
        - to: Second Rocks
          jumps: 3
    - name: Second Rocks
      coord: [25.6, 5.0]
      data:
        flipside: Ebih Breach > Drone Tutorial > Second Rocks
      local:
        - to: First Rocks
          thru: [25.5, 5.0]
          jumps_down: [0, 6]
        - to: Above Rocks
          jumps: 3
    - name: Above Rocks
      coord: [25.5, 4.8]
      data:
        flipside: Ebih Breach > Drone Tutorial > Above Rocks
      local:
        - to: Second Rocks
          thru: [25.6, 4.8]
          jumps_down: [0, 4]
        - to: Upper Mid-way
          jumps: 2
      exits:
        - to: Upper Mid-way
          req: Slingshot_Hook
          movement: base
          jumps: 1.25
    - name: Upper Mid-way
      coord: [25.4, 4.425]
      data:
        flipside: Ebih Breach > Drone Tutorial > Upper Mid-way
      local:
        - to: Above Rocks
        - to: Top
          jumps: 4
      exits:
        - to: Top
          req: Slingshot_Hook
          movement: base
          jumps: 2
    - name: Top
      coord: [25.3, 3.75]
      data:
        flipside: Ebih Breach > Drone Tutorial > Top
      local:
        - to: Upper Mid-way
        - to: West 4

    # Exterior
    - name: West 3
      coord: [25.05, 2.05]
      local:
        - to: Mid-air
          jumps: 1
        - to: East
          jumps: 1
      exits:
        - to: Highest Point
          req: Nanite_Mist
          movement: mist1
        - to: Highest Point
          req: $mist2
          movement: mist2
        - to: Peak > East 3
          tags: [xshift]
    - name: Mid-air
      # this is the optimal placement of this point horizontally to minimize time with fast_hover into mist2
      coord: [25.25, 2.0]
      local:
        - to: West 3
        - to: East
      exits:
        - to: Highest Point
          req: Nanite_Mist
          movement: mist1
        - to: Highest Point
          req: $mist2
          movement: mist2
    - name: Highest Point
      coord: [25.7, 1.2]
      local:
        - to: Mid-air
        - to: East
      locations:
        - name: Flask
          canon: Ebih_High_Flask
          item: Flask
          tags: [flask]
        - name: Shockwave Flask
          canon: Ebih_High_Flask
          item: Flask
          req: $shockwave
          tags: [shockwave]
      hybrid:
        - name: Flask Collection Skip
          canon: Ebih_High_Flask
          item: Flask
          to: Menu > Warp Only > Kiengir
          req: $melee_cskip
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Ebih_High_Flask
          item: Flask
          to: ^map_spot
          req: $melee_cskip and Fast_Travel
          tags: cskip
    - name: East
      coord: [25.95, 4.1]
      exits:
        - to: Open Air > Northeast
          tags: [xshift]

- name: Open Air
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: Northeast
      coord: [26.05, 4.1]
      local:
        - to: South
      exits:
        - to: Ebih East > East Mid-air
          movement: base
          penalty_tags: [yshift, -fall.2]
    - name: South
      coord: [26.2, 5.9]
      exits:
        - to: Ebih East > North
          tags: [xshift]

- name: Grid 26,10-11  # MARK: Grid 26,10-11
  on_entry: $reset_old_area(^newpos)
  map:
    note: [26, 10, 27, 11]
  datamap:
    map_spot:
      note: Menu > Kiengir Map > Terminal Breakthrough 1
  spots:
    - name: West 11
      coord: [26.05, 10.75]
      local:
        - to: Middle Bottom
          jumps: 1
      exits:
        - to: Grid 25,10-12 > East 11
          tags: [xshift]
    - name: Middle Bottom
      coord: [26.4, 10.6]
      local:
        - to: West 11
        - to: Under Ledge
      exits:
        - to: Middle Platform
          req: $hover
    - name: Under Ledge
      coord: [26.6, 10.6]
      local:
        - to: Middle Bottom
      exits:
        - to: Ledge
          req: $grab
        - to: Ledge
          req: $hook
          time: 0.8
    - name: Ledge
      coord: [26.7, 10.35]
      local:
        - to: Middle Platform
        - to: Middle Bottom
        - to: Under Ledge
      exits:
        - to: Upper Platform
          req: $hover
          movement: base
          jumps: 2
      locations:
        - name: Note
          item: Terminal_Breakthrough_1
          tags: [standing]
    - name: Middle Platform
      coord: [26.4, 10.35]
      local:
        - to: West 11
        - to: Upper Platform
          jumps: 2
      exits:
        - to: West 10
          req: $grab
          time: 2.8
        - to: West 10
          req: $hook
          movement: base
          jumps: 3
    - name: Upper Platform
      coord: [26.45, 10.1]
      local:
        - to: West 11
        - to: Ledge
      exits:
        - to: West 10
          req: $grab
          time: 2
        - to: West 10
          req: $hook
          movement: base
          jumps: 2
        - to: Cliff
          req: $grab
          time: 1.15
        - to: Cliff
          req: $hook
          movement: base
          jumps: 1
    - name: West 10
      coord: [26.05, 9.7]
      local:
        - to: Upper Platform
        - to: West 11
          thru: [26.2, 9.7]
      exits:
        - to: Grid 25,10-12 > East 10
          tags: [xshift]
    - name: Cliff
      coord: [26.6, 9.8]
      local:
        - to: Upper Platform
        - to: East 10
          jumps: 1
    - name: East 10
      coord: [26.95, 9.75]
      local:
        - to: Cliff
      exits:
        - to: Observation Tower Room > West 10
          tags: [xshift]

- name: Observation Tower Room  # MARK: Observation Tower Room
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West Mid-air
      coord: [27.05, 7.4]
      local:
        - to: Tower Top
        - to: West 10
          thru: [27.4, 9]
    - name: West 9
      coord: [27.05, 8.3]
      local:
        - to: Tower Top
        - to: West 10
          thru: [27.4, 9]
      exits:
        - to: Ebih East > East 9
          tags: [xshift]
    - name: Tower Top
      coord: [27.5, 8.9]
      local:
        - to: West 10
        - to: East 11
      exits:
        - to: West 9
          req: $grab or $climb
          time: 3
        - to: West 9
          req: $hover
          movement: base
          jumps: 4
    - name: Tower Bottom
      coord: [27.5, 9.9]
      local:
        - to: West 10
          jumps: 1
        - to: Tower Top
          jumps: 6
        - to: East 11
    - name: Cliff
      coord: [27.65, 10.1]
      local:
        - to: West 10
          jumps: 2
        - to: Tower Bottom
          jumps: 1
        - to: East 11
    - name: West 10
      coord: [27.05, 9.75]
      local:
        - to: Tower Bottom
        - to: Cliff
      exits:
        - to: Grid 26,10-11 > East 10
          tags: [xshift]
    - name: East 11
      coord: [27.95, 10.6]
      exits:
        - to: Cliff
          req: $grab or $climb
          time: 2  # ?
        - to: Cliff
          req: $hook
          movement: base
          jumps: 2
        - to: Base Camp > West 11
          tags: [xshift]

- name: Vertical Interchange  # MARK: Vertical Interchange
  on_entry: $reset_old_area(^newpos)
  start:
    _door_open: false
  spots:
    - name: West 13
      coord: [21.05, 12.75]
      local:
        - to: Passage West
        - to: Door West
          jumps: 1
      exits:
        - to: Ebih West > East 13
          tags: [xshift]
      actions:
        - name: Open Door
          req: $open and not ^_door_open
          do: ^_door_open = true
          tags: [hack]
    - name: Passage West
      coord: [21.25, 12.9]
      local:
        - to: West 13
          jumps: 1
      exits:
        - to: Door West
          req: $grab or $climb
          movement: base
          jumps: 2
        - to: Passage East
          req: ^mode == 'drone'
          movement: base
    - name: Door West
      coord: [21.35, 12.65]
      local:
        - to: West 13
        - to: Passage West
      exits:
        - to: Door
          req: ^_door_open
          movement: base
    - name: Door
      coord: [21.5, 12.65]
      exits:
        - to: Door West
          req: ^_door_open
          movement: base
        - to: Door East
          req: ^_door_open
          movement: base
    - name: Door East
      coord: [21.65, 12.65]
      local:
        - to: Passage East
      exits:
        - to: Door
          req: ^_door_open
          movement: base
    - name: Passage East
      coord: [21.8, 12.9]
      local:
        - to: East 13
          jumps: 1
        - to: Middle Descent
      exits:
        - to: Passage West
          req: ^mode == 'drone'
          movement: base
        - to: Door West
          req: $climb
    - name: East 13
      coord: [21.95, 12.75]
      local:
        - to: Passage East
        - to: Middle Descent
      exits:
        - to: Gem Room > West 13
          tags: [xshift]
    - name: Middle Descent
      coord: [21.85, 13.3]
      local:
        - to: Middle Drop
      exits:
        - to: Passage East
          req: $grab or $climb
          movement: base
          jumps: 5  # ?
        - to: East 13
          req: $grab or $climb
          movement: base
          jumps: 5  # ?
    - name: Middle Drop
      coord: [21.2, 13.45]
      local:
        - to: Middle Descent
          jumps: 2
        - to: Cliff by Refill
    - name: Cliff by Refill
      coord: [21.3, 14.4]
      exits:
        - to: Middle Drop
          req: $grab or $climb
          movement: base
          jumps: 9  # ?
        - to: Refill Station
          req: not Ebih_Interchange_Block
          movement: base
        - to: Blocked Refill Station
          req: Ebih_Interchange_Block
          movement: base
    - name: Refill Station
      coord: [21.45, 14.8]
      local:
        - to: East Tunnel
          jumps: 1
      exits:
        - to: Cliff by Refill
          req: $climb
          movement: base
          jumps: 3  # ?
        - to: Below Door
          req: Ebih_Interchange_Gate
          movement: base
    - name: Blocked Refill Station
      coord: [21.45, 14.7]
      local:
        - to: East Tunnel
      exits:
        - to: Cliff by Refill
          req: $grab
          movement: base
          jumps: 2  # ?
        - to: Below Door
          req: Ebih_Interchange_Gate
          movement: base
    - name: Block Cubby
      coord: [21.75, 13.8]
      local:
        - to: Cubby Exit
      locations:
        - name: Shockwave Block
          item: Ebih_Interchange_Block
          req: $shockwave
          price: 100
          tags: [shockwave, event]
    - name: Cubby Exit
      coord: [21.85, 13.9]
      local:
        - to: East Tunnel
      exits:
        - to: Below Door
          req: Ebih_Interchange_Gate
          movement: base
        - to: Blocked Refill Station
          req: Ebih_Interchange_Block
          movement: base
    - name: East Tunnel
      coord: [21.75, 14.7]
      local:
        - to: East 15
      exits:
        - to: Block Cubby
          req: $grab
          movement: base
          jumps: 6  # ?
        - to: Refill Station
          req: not Ebih_Interchange_Block
          movement: base
        - to: Blocked Refill Station
          req: Ebih_Interchange_Block
          movement: base
        - to: Below Door
          req: Ebih_Interchange_Gate
          movement: base
    - name: East 15
      coord: [21.95, 14.75]
      local:
        - to: East Tunnel
          jumps: 1
      exits:
        - to: Amagi > West Lake > West 15
          tags: [xshift]
    - name: Below Door
      coord: [21.55, 15.2]
      local:
        - to: Lower West Cliff
        - to: Switch
        - to: South
      exits:
        - to: Refill Station
          req: Ebih_Interchange_Gate and not Ebih_Interchange_Block and $grab
          movement: base
          jumps: 3
        - to: Blocked Refill Station
          req: Ebih_Interchange_Gate and Ebih_Interchange_Block and $grab
          movement: base
          jumps: 4
        - to: Refill Station
          req: Ebih_Interchange_Gate and not Ebih_Interchange_Block and $hook
          time: 1  # ?
        - to: Blocked Refill Station
          req: Ebih_Interchange_Gate and Ebih_Interchange_Block and $hook
          time: 1  # ?
    - name: Lower West Cliff
      coord: [21.4, 15.4]
      local:
        - to: Switch
        - to: South
        - to: Below Door
          jumps: 1  #  not ledge grab?
    - name: Switch
      coord: [21.6, 15.7]
      local:
        - to: South
      locations:
        - name: Activate Switch
          item: Ebih_Interchange_Gate
          req: $can_damage
          time: 0.25
      exits:
        - to: Below Door
          req: $hook
          time: 1  # ?
    - name: South
      coord: [21.5, 15.8]
      local:
        - to: Switch
          jumps: 1
      exits:
        - to: Below Door
          req: $hook
          time: 1  # ?

- name: Walled Off  # MARK: Walled Off
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: East 12
      coord: [24.95, 11.8]
      local:
        - to: Wall Right
      exits:
        - to: Grid 25,10-12 > West 12
          tags: [xshift]
    - name: Wall Right
      coord: [24.8, 11.8]
      local:
        - to: East 12
      locations:
        - name: Break Wall
          item: Ebih_Walled_Off_Wall
          canon: Ebih_Walled_Off_Wall
          req: $shockwave
          price: 100
          tags: [shockwave, event]
      exits:
        - to: Wall Left
          req: Ebih_Walled_Off_Wall
          movement: base
      hybrid:
        - name: Break Through Wall
          item: Ebih_Walled_Off_Wall
          canon: Ebih_Walled_Off_Wall
          to: Wall Left
          req: Nanite_Mist
          movement: mist1
        - name: Break Through Wall Faster
          item: Ebih_Walled_Off_Wall
          canon: Ebih_Walled_Off_Wall
          to: Wall Left
          req: $mist2
          movement: mist2
    - name: Wall Left
      coord: [24.65, 11.8]
      local:
        - to: Upper Slope
      locations:
        - name: Break Wall
          item: Ebih_Walled_Off_Wall
          canon: Ebih_Walled_Off_Wall
          req: $shockwave
          price: 100
          tags: [shockwave, event]
      exits:
        - to: Wall Right
          req: Ebih_Walled_Off_Wall
          movement: base
        - to: West 12
          req: ^mode == 'drone' and Nanite_Mist
          movement: mist1
        - to: West 12
          req: ^mode == 'drone' and $mist2
          movement: mist2
      hybrid:
        - name: Break Through Wall
          item: Ebih_Walled_Off_Wall
          canon: Ebih_Walled_Off_Wall
          to: Wall Right
          req: Nanite_Mist
          movement: mist1
        - name: Break Through Wall Faster
          item: Ebih_Walled_Off_Wall
          canon: Ebih_Walled_Off_Wall
          to: Wall Right
          req: $mist2
          movement: mist2

    - name: Upper Slope
      coord: [24.5, 11.8]
      local:
        - to: Wall Left
        - to: Upper Left Ledge
        - to: West 14
          thru: [[24.375, 12.0], [24.55, 12.7], [24.45, 13.2]]
      exits:
        - to: West 12
          req: $hook and $hover
          movement: base
          jumps: 2
        - to: West 12
          req: ^mode == 'drone' and Nanite_Mist
          movement: mist1
        - to: West 12
          req: ^mode == 'drone' and $mist2
          movement: mist2
    - name: Upper Left Ledge
      coord: [24.25, 11.95]
      local:
        - to: Upper Slope
          jumps: 2
        - to: Middle Ledge
      exits:
        - to: West 12
          req: $infinite_climb
          movement: base
          jumps: 6
        - to: West 12
          req: $infinite_climb and Slingshot_Hook
          movement: base
          jumps: 4
        - to: West 12
          req: $hook and $hover
          movement: base
          jumps: 3
    - name: West 12
      coord: [24.05, 11.2]
      local:
        - to: Upper Left Ledge
        - to: Middle Ledge
      exits:
        - to: Upper Slope
          req: $hook or $hover
          movement: base
        - to: Guarded Health > East
          req: ^mode == 'drone'
          tags: [xshift]

    - name: Middle Ledge
      coord: [24.45, 12.4]
      local:
        - to: Platform 5
        - to: West 14
          thru: [[24.55, 12.7], [24.45, 13.2]]
      exits:
        - to: Upper Left Ledge
          req: $grab
          movement: base
          jumps: 3
        - to: Upper Slope
          req: $grab
          movement: base
          jumps: 4
        - to: Upper Left Ledge
          req: $hook
          movement: base
          jumps: 2
        - to: Upper Slope
          req: $hook
          movement: base
          jumps: 2
    - name: Platform 5
      coord: [24.6, 12.9]
      local:
        - to: West 14
        - to: Platform 4
        - to: Platform 3
      exits:
        - to: Middle Ledge
          req: $grab
          movement: base
          jumps: 2
        - to: Middle Ledge
          req: $hook
          movement: base
          jumps: 1
    - name: Platform 4
      coord: [24.45, 13.05]
      local:
        - to: Platform 5
          jumps: 1
        - to: Platform 3
        - to: West 14
          thru: [24.2, 13.1]
    - name: Platform 3
      coord: [24.5, 13.35]
      local:
        - to: West 14
      exits:
        - to: Platform 4
          req: $grab
          movement: base
          jumps: 2
        - to: Platform 4
          req: $hook
          movement: base
          jumps: 1
    - name: West 14
      coord: [24.05, 13.8]
      local:
        - to: Platform 3
          jumps: 3
      exits:
        - to: Gem Room > East 14
          tags: [xshift]

- name: Guarded Health  # MARK: Guarded Health
  on_entry: $reset_old_area(^newpos)
  map:
    west: [21, 11, 22, 12]
  datamap:
    map_spot:
      west: Menu > Kiengir Map > Ebih Guarded Health
  spots:
    - name: East
      coord: [23.95, 11.2]
      local:
        - to: East Hills
        - to: East Ruins
      exits:
        - to: Walled Off > West 12
          req: ^mode == 'drone'
          tags: [xshift]
    - name: East Hills
      coord: [23.65, 11.6]
      local:
        - to: East Ruins
          jumps: 2
      exits:
        - to: East
          req: $hook
          movement: base
          jumps: 1
    - name: East Ruins
      coord: [23.35, 11.4]
      local:
        - to: East Hills
        - to: Small Pond
          jumps: 5
        - to: West Hill
          jumps: 7
      exits:
        - to: East
          req: $hover
          movement: base
          jumps: 2
    - name: Small Pond
      coord: [22.5, 11.65]
      local:
        - to: East Ruins
          jumps: 4
        - to: West Hill
          jumps: 2
      exits:
        - to: East Ruins
          req: $hook and $hover
          movement: fast_hover
          jumps: 1
    - name: West Hill
      coord: [22.05, 11.35]
      local:
        - to: Small Pond
        - to: West Basin
        - to: Far West
        - to: East Ruins
    - name: West Basin
      coord: [21.6, 11.8]
      local:
        - to: West Hill
          jumps: 4
        - to: Far West
          jumps: 2
      locations:
        - name: Health
          item: Health_Fragment
          tags: [standing]
    - name: Far West
      coord: [21.2, 11.5]
      local:
        - to: West Basin
        - to: West Hill
          jumps: 5
      locations:
        - name: Refill
          item: Power_Core
          req: $more_refills
          tags: [standing]

- name: Gem Room  # MARK: Gem Room
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [22, 12, 23, 13]
    button: [23, 12, 24, 13]
    gem: [23, 13, 24, 14]
  datamap:
    map_spot:
      flask: Menu > Kiengir Map > Ebih Gem Room Flask
      button: Menu > Kiengir Map > Ebih Gem Room Button
      gem: Menu > Kiengir Map > Diviner's Gem
  spots:
    - name: West 13
      coord: [22.05, 12.75]
      local:
        - to: West Side
        - to: East Side
        - to: Below East Gate
      exits:
        - to: Vertical Interchange > East 13
          tags: [xshift]
        - to: West Gate
          req: $hook or $hover
          movement: base
    - name: West Mid-air
      coord: [22.5, 13.5]
      local:
        - to: West Side
      exits:
        - to: West 13
          req: $hook
          movement: base
          jumps: 3
    - name: West Side
      coord: [22.6, 13.6]
      local:
        - to: West Mid-air
          jumps: 1
        - to: East Side
        - to: Below East Gate
          jumps: 1
      exits:
        - to: West 13
          req: $hook
          movement: base
          jumps: 4
        - to: West 13
          req: $grab
          movement: base
          jumps: 5
        - to: Below East Gate
          req: $hook and $hover
          movement: fast_hover
          jumps: 1
        - to: East 14
          req: $hook and $hover
          movement: fast_hover
          jumps: 1
    - name: Below East Gate
      coord: [23.2, 13.5]
      local:
        - to: East Side
        - to: West Side
      exits:
        - to: East Gate
          req: $hook
          movement: base
          jumps: 2
        - to: Air Corner
          req: Nanite_Mist
          movement: mist1
        - to: Air Corner
          req: $mist2
          movement: mist2
    - name: East Side
      coord: [23.5, 13.7]
      local:
        - to: East Slope
        - to: Below East Gate
          jumps: 1
        - to: West Side
          jumps: 1
      exits:
        - to: West Mid-air
          req: $hook and $hover
          movement: fast_hover
          jumps: 1
        - to: East Gate
          req: $hook and $hover
          movement: base
          jumps: 2
        - to: Air Corner
          req: Nanite_Mist
          movement: mist1
        - to: Air Corner
          req: $mist2
          movement: mist2
    - name: East Slope
      coord: [23.7, 13.7]
      local:
        - to: East Side
        - to: East 14
      exits:
        - to: Tunnel Entrance
          req: Nanite_Mist
          movement: mist1
        - to: Tunnel Entrance
          req: $mist2
          movement: mist2
    - name: East 14
      coord: [23.95, 13.8]
      local:
        - to: East Slope
          jumps: 1
      exits:
        - to: Walled Off > West 14
          tags: [xshift]
        - to: Tunnel Entrance
          req: Nanite_Mist
          movement: mist1
        - to: Tunnel Entrance
          req: $mist2
          movement: mist2

    - name: West Gate
      coord: [22.8, 13.1]
      local:
        - to: West Mid-air
        - to: West Side
      exits:
        - to: West 13
          req: $hover
          movement: base
          jumps: 1
        - to: Between Gates
          req: Ebih_Gem_Room_Gate
          movement: base
    - name: East Gate
      coord: [23.2, 13.1]
      local:
        - to: Below East Gate
        - to: East Side
      exits:
        - to: Air Corner
          req: Nanite_Mist
          movement: mist1
        - to: Air Corner
          req: $mist2
          movement: mist2
        - to: Between Gates
          req: Ebih_Gem_Room_Gate
          movement: base
    - name: Air Corner
      coord: [23.45, 12.9]
      local:
        - to: Below East Gate
        - to: East Side
      exits:
        - to: Tunnel Entrance
          req: Nanite_Mist
          movement: mist1
        - to: Tunnel Entrance
          req: $mist2
          movement: mist2
    - name: Tunnel Entrance
      coord: [23.45, 12.5]
      local:
        - to: Air Corner
        - to: East Slope
        - to: East 14
      exits:
        - to: Tunnel Interior
          req: ^mode == 'drone'
          movement: base
    - name: Tunnel Interior
      coord: [23.3, 12.5]
      local:
        - to: Upper Tunnel East
          jumps: 3
      exits:
        - to: Tunnel Entrance
          req: ^mode == 'drone'
          movement: base
        - to: Upper Tunnel East
          req: Nanite_Mist
          movement: mist1
        - to: Upper Tunnel East
          req: $mist2
          movement: mist2
    - name: Upper Tunnel East
      coord: [23.15, 12.15]
      local:
        - to: Upper Tunnel West
        - to: Tunnel Interior
    - name: Upper Tunnel West
      coord: [22.925, 12.15]
      local:
        - to: Upper Tunnel East
        - to: Button Corner
    - name: Button Corner
      coord: [22.9, 12.5]
      local:
        - to: Button Nearby
      locations:
        - name: Remote Button
          canon: Ebih_Gem_Room_Gate
          item: Ebih_Gem_Room_Gate
          req: $boomerang
          tags: [button]
        - name: Shockwave Secret Flask
          canon: Ebih_Gem_Room_Flask
          item: Flask
          req: $shockwave
          price: 100
          tags: [shockwave]
      exits:
        - to: Upper Tunnel West
          req: $climb
          movement: base
          jumps: 2
        - to: Upper Tunnel West
          req: $hook
          movement: base
          jumps: 1
        - to: Upper Tunnel West
          req: Nanite_Mist
          movement: mist1
        - to: Upper Tunnel West
          req: $mist2
          movement: mist2
    - name: Button Nearby
      coord: [23.0, 12.5]
      local:
        - to: Button Corner
      locations:
        - name: Hit Button
          canon: Ebih_Gem_Room_Gate
          item: Ebih_Gem_Room_Gate
          req: $can_damage
          tags: [button]

    - name: Between Gates
      coord: [23.0, 13.1]
      locations:
        - name: Gem
          item: Diviners_Gem
          tags: [standing]
      exits:
        - to: West Gate
          req: Ebih_Gem_Room_Gate
          movement: base
        - to: East Gate
          req: Ebih_Gem_Room_Gate
          movement: base
        - to: Hidden Tunnel
          req: $hook
          movement: base
          jumps: 1
        - to: Hidden Tunnel
          req: Nanite_Mist
          movement: mist1
        - to: Hidden Tunnel
          req: $mist2
          movement: mist2
    - name: Hidden Tunnel
      coord: [23.0, 12.7]
      local:
        - to: Between Gates
        - to: Hidden Tunnel Corner
    - name: Hidden Tunnel Corner
      coord: [22.8, 12.7]
      local:
        - to: Hidden Cache
          jumps: 1
        - to: Hidden Tunnel
      locations:
        - name: Shockwave Flask
          canon: Ebih_Gem_Room_Flask
          item: Flask
          req: $shockwave
          tags: [shockwave]
        - name: Boomerang Flask
          canon: Ebih_Gem_Room_Flask
          item: Flask
          req: $bs
          tags: [nearby_flask]
    - name: Hidden Cache
      coord: [22.75, 12.5]
      local:
        - to: Hidden Tunnel Corner
      locations:
        - name: Flask
          canon: Ebih_Gem_Room_Flask
          item: Flask
          tags: [flask]
      hybrid:
        - name: Flask Collection Skip
          canon: Ebih_Gem_Room_Flask
          item: Flask
          req: $melee_cskip
          to: Menu > Warp Only > Kiengir
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Ebih_Gem_Room_Flask
          item: Flask
          req: $melee_cskip and Fast_Travel
          to: ^map_spot
          tags: [cskip]

- name: Party Central  # MARK: Party Central
  on_entry: $reset_old_area(^newpos)
  data:
    portal_start: Portal Stand
  map:
    portal: [25, 13, 26, 14]
    flask: [26, 13, 27, 14]
  datamap:
    map_spot:
      portal: Menu > Kiengir Map > Ebih Party Central Portal
      flask: Menu > Kiengir Map > Ebih Party Central Flask
  spots:
    - name: Portal Stand
      coord: [25.325, 13.7]
      data:
        flipside: Ebih Breach > Lake Gate > Outside West
      local:
        - to: Waterfall Platform
          jumps: 1
        - to: Below Between Waterfalls
    - name: Mid-air Between Waterfalls
      coord: [25.5, 13.35]
      data:
        flipside: SpotId::None
      local:
        - to: Portal Stand
        - to: Waterfall Platform
        - to: Below Between Waterfalls
          jumps_down: 1
        - to: Below Waterfall
          jumps_down: 1
    - name: Mid-air East of Waterfall
      coord: [25.75, 13.35]
      data:
        flipside: SpotId::None
      local:
        - to: Waterfall Platform
        - to: Below Waterfall
          jumps_down: 1
        - to: Bottom Mid-east
    - name: Waterfall Platform
      coord: [25.6, 13.55]
      local:
        - to: Portal Stand
        - to: Below Between Waterfalls
          jumps_down: 1
        - to: Below Waterfall
          jumps_down: 1
        - to: Bottom Mid-east
    - name: Below Waterfall
      coord: [25.6, 13.75]
      data:
        flipside: Ebih Breach > Lake Gate > Button
      local:
        - to: Below Between Waterfalls
        - to: Waterfall Platform
          jumps: 1
        - to: Bottom Mid-east
    - name: Below Between Waterfalls
      coord: [25.5, 13.75]
      data:
        flipside: Ebih Breach > Lake Gate > Interior
      local:
        - to: Portal Stand
          jumps: 1
        - to: Waterfall Platform
          jumps: 1
        - to: Below Waterfall
    - name: Bottom Mid-east
      coord: [26.2, 13.75]
      local:
        - to: Below Waterfall
        - to: Waterfall Platform
          jumps: 1
        - to: Bottom East
    - name: Bottom East
      coord: [26.35, 13.75]
      local:
        - to: Bottom Mid-east
        - to: East Trough
      locations:
        - name: Shockwave Flask
          canon: Ebih_Party_Central_Flask
          item: Big_Flask
          req: $shockwave
          price: 100
          tags: [shockwave]
    - name: East Trough
      coord: [26.5, 13.8]
      local:
        - to: Bottom East
          jumps: 1
      locations:
        - name: Flask
          canon: Ebih_Party_Central_Flask
          item: Big_Flask
          tags: [flask]
      hybrid:
        - name: Flask Collection Skip
          canon: Ebih_Party_Central_Flask
          item: Big_Flask
          to: Menu > Warp Only > Kiengir
          req: $melee_cskip
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Ebih_Party_Central_Flask
          item: Big_Flask
          to: ^map_spot
          req: $melee_cskip and Fast_Travel
          tags: [cskip]
