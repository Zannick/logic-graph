name: Annuna Breach
graph_offset: [0, 30]
data:
  realm: breach

areas:
- name: Smiley  # MARK: Smiley
  on_entry: $reset_old_area(^newpos)
  map:
    nw: [32, 26, 33, 27]
    health: [33, 27, 34, 28]
  datamap:
    map_spot:
      nw: Menu > Breach Map > AGB Smiley Northwest
      health: Menu > Breach Map > AGB Smiley Health
  spots:
    - name: West
      coord: [32.1, 26.75]
      local:
        - to: West Ground
      exits:
        - to: Uhrum Breach > Annuna Gate > East
          tags: [xdoor]
        - to: Upper Portal Exit
          req: Drone_Hover
          movement: base
          jumps: 1
    - name: West Ground
      coord: [32.2, 26.85]
      data:
        flipside: Annuna > Smiley Room > West Side
      local:
        - to: West
          jumps: 1
        - to: Upper Portal Exit
          jumps: 2
      exits:
        - to: Upper Portal Exit
          req: Slingshot_Hook
          movement: fast_hover
          jumps: 1
    - name: Upper Portal Exit
      coord: [32.475, 26.6]
      data:
        flipside: Annuna > Smiley Room > Upper Portal Stand
      local:
        - to: West Ground
        - to: Column East
          jumps: 1
      exits:
        - to: Northeast Ledge
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
          penalties:
            - when: not Slingshot_Weapon
              add: 0.5  # timing to evade the enemy
        - to: North
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
          penalties:
            - when: not Slingshot_Weapon
              add: 0.5  # timing to evade the enemy
        - to: Column East
          req: Slingshot_Hook
          movement: fast_hover
          jumps: 1
    - name: Column East
      coord: [32.8, 26.4]
      local:
        - to: Upper Portal Exit
      exits:
        - to: Northeast Ledge
          req: Drone_Hover
          movement: base
          jumps: 1
        - to: Northeast Ledge
          req: Slingshot_Hook
          movement: base
          jumps: 2
        - to: Upper Portal Exit
          req: Slingshot_Hook and Drone_Hover and Slingshot_Weapon
          movement: fast_hover
        - to: Uhrum Breach > Annuna Gate > Save Point
          req: Slingshot_Hook and Drone_Hover and Slingshot_Weapon
          movement: fast_hover
          penalty_tags: [xdoor, -fast_hover.2]
    - name: Northeast Ledge
      coord: [33.35, 26.35]
      data:
        flipside: Annuna > Smiley Room > East Column West
      local:
        - to: Northeast Corner
        - to: North
          jumps: 1
      exits:
        - to: Column East
          req: Drone_Hover
          movement: base
        - to: Column East
          req: Slingshot_Hook
          movement: base
          jumps: 2
    - name: Northeast Corner
      coord: [33.525, 26.35]
      data:
        flipside: Annuna > Smiley Room > East Column East
      local:
        - to: North
          jumps: 1
        - to: Northeast Ledge
    - name: North
      coord: [33.5, 26.2]
      local:
        - to: Northeast Ledge
        - to: Northeast Corner
      exits:
        - to: Corner > South
          tags: [ydoor]

    - name: Lower Portal Exit
      coord: [32.475, 27.5]
      data:
        flipside: Annuna > Smiley Room > Lower Portal Stand
      local:
        - to: Drool
    - name: Drool
      coord: [33.05, 27.75]
      data:
        flipside: Annuna > Smiley Room > Bottom
      local:
        - to: Lower Portal Exit
          jumps: 3
      locations:
        - name: Health
          item: Health_Fragment
          tags: [standing]
      exits:
        - to: Lower Portal Exit
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 2

- name: Corner  # MARK: Corner
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: South
      coord: [33.5, 25.8]
      local:
        - to: Somewhat Middle-ish
      exits:
        - to: Smiley > North
          tags: [ydoor]
    - name: Somewhat Middle-ish
      coord: [33.6, 25.8]
      data:
        flipside: Annuna > Mirror Match > Plinth Adjacent
      local:
        - to: South
        - to: East
    - name: East
      coord: [33.9, 25.8]
      local:
        - to: Somewhat Middle-ish
      exits:
        - to: Underbelly > West
          tags: [xdoor]

- name: Underbelly  # MARK: Underbelly
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: North
      coord: [34.5, 25.2]
      local:
        - to: Upper Left
        - to: Upper Ledge
      exits:
        - to: Double Corridor > South
          tags: [ydoor]
    - name: Upper Left
      coord: [34.4, 25.35]
      data:
        flipside: Annuna > West Bridge > Lower West Mid-air
      local:
        - to: Upper Ledge
        - to: North
          jumps: 1
    - name: Upper Ledge
      coord: [35.25, 25.35]
      local:
        - to: North
          jumps: 1
        - to: Upper Left
        - to: East Ledge
        - to: Middle Block
      exits:
        - to: Upper Left
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
        - to: North
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 2
    - name: East Ledge
      coord: [35.4, 25.75]
      data:
        flipside: Annuna > West Bridge > Lower Brick Column West
      local:
        - to: Middle Block
      exits:
        - to: Upper Ledge
          req: Slingshot_Hook
          movement: base
          jumps: 1
    - name: Middle Block
      coord: [35.2, 25.9]
      local:
        - to: West Block
        - to: East Ledge
          jumps: 1
      exits:
        - to: Upper Ledge
          req: Slingshot_Hook
          movement: base
          jumps: 2
        - to: East Ledge
          req: Slingshot_Hook
          movement: fast_hover
          jumps: 1
    - name: West Block
      coord: [34.6, 25.9]
      local:
        - to: Middle Block
        - to: Empty Plinth
      exits:
        - to: Middle Block
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
        - to: West Ledge
          req: Slingshot_Hook or Drone_Hover
          movement: base
          jumps: 1
    - name: Empty Plinth
      coord: [34.5, 26.3]
      exits:
        - to: West Ledge
          req: Slingshot_Hook
          movement: base
          jumps: 2
        - to: West Block
          req: Slingshot_Hook
          movement: base
          jumps: 2
        - to: West Block
          req: Drone_Hover
          movement: base
          jumps: 4
    - name: West Ledge
      coord: [34.2, 25.8]
      data:
        flipside: Annuna > West Bridge > Lower West Ledge
      local:
        - to: Empty Plinth
        - to: West
      exits:
        - to: West Block
          req: Slingshot_Hook or Drone_Hover
          movement: base
        - to: Corner > South
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
          penalty_tags: [xdoor, -fast_hover.2]
    - name: West
      coord: [34.1, 25.8]
      local:
        - to: West Ledge
      exits:
        - to: Corner > East
          tags: [xdoor]

- name: Double Corridor  # MARK: Double Corridor
  on_entry: $reset_old_area(^newpos)
  data:
    save_point: Save Point
  map:
    save: [35, 24, 36, 25]
  datamap:
    map_spot:
      save: Menu > Breach Map > AGB Bridge Lower
  spots:
    - name: Save Point
      coord: [35.475, 24.7]
      data:
        flipside: Annuna > West Bridge > Plinth
      exits:
        - to: Center Platform East
          req: Slingshot_Hook
          movement: base
          jumps: 2
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Center Platform East
      coord: [35.3, 24.3]
      local:
        - to: Center Platform West
        - to: Save Point
      exits:
        - to: Center Platform West
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
    - name: Center Platform West
      coord: [34.35, 24.3]
      local:
        - to: Bottom Left
        - to: Center Platform East
      exits:
        - to: Center Platform East
          req: Slingshot_Hook and Drone_Hover
          movement: fast_hover
    - name: Bottom Left
      coord: [34.35, 24.8]
      data:
        flipside: Annuna > West Bridge > West Outcropping
      local:
        - to: South
      exits:
        - to: Center Platform West
          req: Slingshot_Hook
          movement: base
          jumps: 2
    - name: South
      coord: [34.5, 24.8]
      local:
        - to: Bottom Left
      exits:
        - to: Underbelly > North
          tags: [ydoor]
