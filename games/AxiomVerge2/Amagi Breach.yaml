name: Amagi Breach
graph_offset: [0, 30]
data:
  realm: breach
  water: true

areas:
- name: East Entrance  # MARK: East Entrance
  on_entry: $reset_old_area(^newpos)
  map:
    save: [37, 15, 38, 16]
    health: [37, 14, 38, 15]
  data:
    save_point: Save Point
  datamap:
    map_spot:
      save: Menu > Breach Map > LAB East
      health: Menu > Breach Map > LAB East Health
  spots:
    - name: East
      coord: [37.9, 14.75]
      local:
        - to: Grate Right
          jumps: 1
      exits:
        - to: Glacier Breach > South Save > West
          tags: [xdoor]
    - name: Grate Right
      coord: [37.85, 14.7]
      data:
        flipside: Glacier > Crystals > Portal Cage
      local:
        - to: East
      exits:
        - to: Grate Left
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
    - name: Grate Left
      coord: [37.75, 14.7]
      data:
        flipside: Glacier > Crystals > Grate Left
      local:
        - to: Save Point
        - to: West
      exits:
        - to: Upper Slope
          req: $hover
          movement: base
          jumps: 1
        - to: Grate Right
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
    - name: Upper Slope
      coord: [37.3, 14.6]
      local:
        - to: Save Point
        - to: West
          thru: [37.4, 14.7]
        - to: Grate Left
          req: $hover
          movement: base
      locations:
        - name: Item
          item: Health_Fragment
          tags: [standing]
    - name: Save Point
      coord: [37.475, 15.6]
      data:
        flipside: Glacier > Crystals > Portal Stand
      local:
        - to: West
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: West
      coord: [37.1, 15.75]
      local:
        - to: Save Point
          jumps: 1
      exits:
        - to: East Connector > East
          tags: [xdoor]

- name: East Connector  # MARK: East Connector
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: East
      coord: [36.9, 15.75]
      local:
        - to: Center Right
        - to: Outcrop
          thru: [36.75, 15.75]
          jumps: [0, 1]
          jump_mvmt: water
      exits:
        - to: East Entrance > West
          tags: [xdoor]
    - name: Center Right
      coord: [36.6, 15.75]
      data:
        flipside: Glacier > Vertical Room > Middle Gatestone
      local:
        - to: Center Left
        - to: East
        - to: Outcrop
          jumps: 1
          jump_mvmt: water
    - name: Center Left
      coord: [36.45, 15.75]
      data:
        flipside: Glacier > Vertical Room > Middle Gatestone Left
      local:
        - to: West
        - to: Center Right
    - name: Outcrop
      coord: [36.75, 15.4]
      data:
        flipside: Glacier > Vertical Room > Outcrop by Middle Gatestone
      local:
        - to: Center Left
        - to: East
          thru: [36.75, 15.6]
    - name: West
      coord: [36.1, 15.75]
      local:
        - to: Center Left
      exits:
        - to: East Column > East
          tags: [xdoor]

- name: East Column  # MARK: East Column
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: East
      coord: [35.9, 15.75]
      local:
        - to: Top
      exits:
        - to: East Connector > West
          tags: [xdoor]
    - name: Top
      coord: [35.65, 15.75]
      local:
        - to: East
        - to: Upper
    - name: Upper
      coord: [35.5, 16.1]
      local:
        - to: Top
          jumps: 1
        - to: Middle
    - name: Middle
      coord: [35.35, 16.65]
      local:
        - to: Lower Side
        - to: Lower
          thru: [35.3, 17.0]
        - to: Upper
          jumps: 2
          jump_mvmt: water
    - name: Lower Side
      coord: [35.1, 17.15]
      local:
        - to: Lower
        - to: Middle
          jumps: 1
          jump_mvmt: water
    - name: Lower
      coord: [35.35, 17.35]
      local:
        - to: Lower Side
          jumps: 1
        - to: South
    - name: South
      coord: [35.5, 17.8]
      local:
        - to: Lower
          jumps: 2
      exits:
        - to: Fishy Secrets > North
          tags: [ydoor]

- name: East Ruins  # MARK: East Ruins
  on_entry: $reset_old_area(^newpos)
  data:
    save_point: Save Point
  map:
    save: [33, 16, 34, 17]
    flask: [34, 15, 35, 16]
    urn: [34, 17, 35, 18]
  datamap:
    map_spot:
      save: Menu > Breach Map > LAB Center
      flask: Menu > Breach Map > LAB East Ruins Flask
      urn: Menu > Breach Map > Exit Breach
  spots:
    - name: West
      coord: [31.1, 17.75]
      local:
        - to: West Bubbly Pillar
          jumps: 2
          jump_mvmt: water
      exits:
        - to: Center Ruins > East 18
          tags: [xdoor]
    - name: West Bubbly Pillar
      coord: [31.4, 17.2]
      data:
        flipside: Amagi > Gated Community > Platform 1 West
      local:
        - to: West
        - to: West Bubbly Platform
          jumps: 3
    - name: West Bubbly Platform
      coord: [31.6, 16.5]
      local:
        - to: Left Rocky Pillar West
          jumps: 1
          jump_mvmt: water
      exits:
        - to: West Bubbly Pillar
          movement: bubbles
        - to: West Bubbly Pillar
          req: Underwater_Movement
          movement: water_bubbles
        - to: West Bubbly Pillar
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
    - name: Left Rocky Pillar West
      coord: [31.75, 16.1]
      local:
        - to: West Bubbly Platform
        - to: Left Rocky Pillar East
          jumps: 1
      exits:
        - to: West Bubbly Pillar
          movement: bubbles
        - to: West Bubbly Pillar
          req: Underwater_Movement
          movement: water_bubbles
        # TODO: fast_hover movements
    - name: Left Rocky Pillar East
      coord: [32.45, 15.8]
      local:
        - to: Left Rocky Pillar West
        - to: South
        - to: Little Rock
        - to: Center Rock West
        - to: Save Point
    - name: South
      coord: [32.5, 17.8]
      local:
        - to: Little Rock
          thru: [32.3, 17.4]
          jumps: [1, 1]
          jump_mvmt: water
      exits:
        - to: Upper Hallway > North
          tags: [ydoor]
    - name: Little Rock
      coord: [32.65, 17.1]
      local:
        - to: South
        - to: Under the Rock
        - to: Center Rock West
          jumps: 1
          jump_mvmt: water
    - name: Center Rock West
      coord: [32.8, 16.75]
      local:
        - to: South
        - to: Little Rock
        - to: Save Point
          jumps: 3
      exits:
        - to: Left Rocky Pillar East
          req: Underwater_Movement and Drone_Hover and Slingshot_Hook
          movement: water
          jumps: 3
        - to: Left Rocky Pillar East
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
    - name: Save Point
      coord: [33.45, 16.3]
      data:
        flipside: Amagi > East Lake > Portal Stand
      local:
        - to: Center Rock West
        - to: Center Rock East
        - to: High Rock West
          jumps: 3
          jump_mvmt: base
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Center Rock East
      coord: [33.8, 16.5]
      local:
        - to: Save Point
          jumps: 1
        - to: Under the Rock
        - to: Small Column West

    - name: Under the Rock
      coord: [33.2, 17.75]
      local:
        - to: Little Rock
          jumps: 2
      exits:
        - to: Small Column West
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
    - name: Small Column West
      coord: [33.9, 17.1]
      data:
        flipside: Amagi > East Lake > Southwest Column West
      local:
        - to: Under the Rock
      exits:
        - to: Center Rock East
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 1
    - name: High Rock West
      coord: [33.3, 15.5]
      local:
        - to: Save Point
        - to: Center Rock West
        - to: High Rock Middle Ledge
    - name: High Rock Middle Ledge
      coord: [33.65, 15.5]
      local:
        - to: High Rock West
        - to: High Rock East Ledge
    - name: High Rock East Ledge
      coord: [34.1, 15.75]
      local:
        - to: High Rock Middle Ledge
          jumps: 1
        - to: High Rock Lower Ledge
    - name: High Rock Lower Ledge
      coord: [34.2, 16.0]
      local:
        - to: High Rock Middle Ledge
          jumps: 1
          jump_mvmt: water
        - to: Northeast Bubbles Center
          jumps: 1
          jump_mvmt: water
        - to: Arch West
        - to: Small Column East
    - name: Northeast Bubbles Center
      coord: [34.4, 15.6]
      local:
        - to: Northeast Bubbles Corner Access
          jumps: 2
        - to: High Rock East Ledge
        - to: High Rock Lower Ledge
      exits:
        - to: Northeast Bubbles Corner Access
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
    - name: Northeast Bubbles Southeast
      coord: [34.7, 16.0]
      local:
        - to: Arch East
        - to: Northeast Bubbles Corner Access
          jumps: 3
    - name: Northeast Bubbles Corner Access
      coord: [34.8, 15.25]
      local:
        - to: Northeast Corner
        - to: Northeast Bubbles Southeast
        - to: High Rock East Ledge
      locations:
        - name: Item
          canon: LAB_East_Ruins_Flask
          item: Big_Flask
          tags: [flask]
    - name: Northeast Corner
      coord: [34.9, 15.25]
      local:
        - to: Northeast Corner
      exits:
        - to: Northeast Bubbles Southeast
          movement: bubbles
      hybrid:
        - name: Flask Collection Skip
          canon: LAB_East_Ruins_Flask
          item: Big_Flask
          to: Menu > Warp Only > Breach
          tags: [cskip]
        - name: Flask Fast Travel
          canon: LAB_East_Ruins_Flask
          item: Big_Flask
          req: Fast_Travel
          to: ^map_spot
          tags: [cskip]

    - name: Arch West
      coord: [34.35, 16.8]
      data:
        flipside: Amagi > East Lake > Arch West
      local:
        - to: Arch East
        - to: Plinth
          thru: [34.35, 17.25]
        - to: Small Column East
      exits:
        - to: High Rock Lower Ledge
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
        - to: Northeast Bubbles Corner Access
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
    - name: Arch East
      coord: [34.65, 16.8]
      data:
        flipside: Amagi > East Lake > Arch East
      local:
        - to: Arch West
        - to: Plinth
          thru: [34.65, 17.25]
        - to: Southeast Rock Wall
    - name: Plinth
      coord: [34.5, 17.6]
      data:
        flipside: Amagi > East Lake > Save Point
      locations:
        - name: Urn
          canon: Exit_Breach
          item: Exit_Breach
          tags: [urn]
      exits:
        - to: Small Column East
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
        - to: Southeast Rock Wall
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 3
      hybrid:
        - name: Urn Collection Skip
          canon: Exit_Breach
          item: Exit_Breach
          to: Menu > Warp Only > Breach
          tags: [cskip]
        - name: Urn Fast Travel
          canon: Exit_Breach
          item: Exit_Breach
          req: Fast_Travel
          to: ^map_spot
          tags: [cskip]
    - name: Small Column East
      coord: [34.15, 17.1]
      data:
        flipside: Amagi > East Lake > Southwest Column East
      local:
        - to: Plinth
        - to: Arch West
          jumps: 1
          jump_mvmt: water
    - name: Southeast Rock Wall
      coord: [34.8, 17.1]
      data:
        flipside: Amagi > East Lake > Southeast Column
      local:
        - to: Plinth
        - to: Arch East
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Arch East
          req: Slingshot_Hook
          movement: base
          jumps: 1

- name: Center Ruins  # MARK: Center Ruins
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [28, 18, 29, 19]
  datamap:
    map_spot:
      flask: Menu > Breach Map > LAB Center Ruins Flask
  spots:
    - name: West
      coord: [28.1, 17.75]
      exits:
        - to: West Ruins > East
          tags: [xdoor]
        - to: West Pillar
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
        - to: West Pillar
          req: Slingshot_Hook
          movement: base
          jumps: 2
        - to: West Pillar
          req: Underwater_Movement and Drone_Hover
          movement: water
          jumps: 3
    - name: West Pillar
      coord: [28.35, 17.35]
      exits:
        - to: West
          req: Underwater_Movement
          movement: water
        - to: West
          req: Drone_Hover
          movement: base
        - to: Center Shaft Top
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
        - to: Center Shaft Top
          req: Underwater_Movement and (Slingshot_Hook or Drone_Hover)
          movement: water
          jumps: 2
        - to: Center Shaft Top
          req: Slingshot_Hook or Drone_Hover
          movement: base
          jumps: 2
    - name: Center Shaft Top
      coord: [29.5, 17.2]
      local:
        - to: Center Shaft Bottom
        - to: East Ledge
      exits:
        - to: West Pillar
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
        - to: West Pillar
          req: Underwater_Movement and (Slingshot_Hook or Drone_Hover)
          movement: water
        - to: West Pillar
          req: Slingshot_Hook or Drone_Hover
          movement: base
    - name: Center Shaft Top East
      coord: [29.6, 17.5]
      local:
        - to: East Ledge
        - to: Center Shaft Bottom
    - name: East Ledge
      coord: [29.85, 17.5]
      local:
        - to: Center Shaft Top
          jumps: 1
          jump_mvmt: water
        - to: Upper East Left
        - to: Center Shaft Top East
      exits:
        - to: Center Shaft Top
          req: Slingshot_Hook or Drone_Hover
          movement: base
          jumps: 2
        - to: Center Shaft Top East
          req: Underwater_Movement and Slingshot_Hook
          movement: fast_hover
        - to: Center Shaft Top
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
    - name: Upper East Left
      coord: [30.05, 17.95]
      local:
        - to: Upper East Right
      exits:
        - to: East Ledge
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
        - to: East Ledge
          req: Slingshot_Hook
          movement: base
          jumps: 2
    - name: Upper East Right
      coord: [30.6, 17.95]
      local:
        - to: Upper East Left
        - to: East 18
          jumps: 1
      exits:
        - to: East 18
          req: Underwater_Movement and Slingshot_Hook
          movement: fast_hover
          jumps: 1
    - name: East 18
      coord: [30.9, 17.75]
      local:
        - to: Upper East Right
      exits:
        - to: East Ruins > West
          tags: [xdoor]
    - name: Center Shaft Bottom
      coord: [29.6, 18.3]
      local:
        - to: East 19
        - to: South
          thru: [30.45, 18.6]
        - to: Passage Entrance
          thru: [30.45, 18.6]
      exits:
        - to: Center Shaft Top
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
        - to: Center Shaft Top East
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
    - name: East 19
      coord: [30.9, 18.65]
      local:
        - to: South
        - to: Passage Entrance
        - to: Center Shaft Bottom
          jumps: 2
          jump_mvmt: water
      exits:
        - to: Upper Hallway > West
          tags: [xdoor]
    - name: South
      coord: [30.5, 18.8]
      local:
        - to: Passage Entrance
          jumps: 1
        - to: East 19
          jumps: 1
        - to: Center Shaft Bottom
          jumps: 2
          jump_mvmt: water
      exits:
        - to: Twisty Passages > North
          tags: [ydoor]
    - name: Passage Entrance
      coord: [30.4, 18.75]
      local:
        - to: South
        - to: East 19
          jumps: 1
        - to: Center Shaft Bottom
          thru: [30.45, 18.6]
          jumps: [1, 2]
          jump_mvmt: water
      locations:
        - name: Mist Through Passage
          canon: Amagi_Breach_Center_Ruins_Blocks
          item: Amagi_Breach_Center_Ruins_Blocks
          req: Nanite_Mist
          to: Passage Exit
          movement: mist2
          penalties:
            - add: 1.5  # twists and turns
            - when: not Mist_Upgrade
              movement: mist1
      exits:
        - to: Passage Exit
          req: Underwater_Movement and Amagi_Breach_Center_Ruins_Blocks
          movement: water
          jumps: 2
          penalties:
            - add: 1.5  # twists and turns
    - name: Passage Exit
      coord: [28.5, 18.65]
      locations:
        - name: Mist Through Passage
          canon: Amagi_Breach_Center_Ruins_Blocks
          item: Amagi_Breach_Center_Ruins_Blocks
          req: Nanite_Mist
          to: Passage Entrance
          movement: mist2
          penalties:
            - add: 1.5  # twists and turns
            - when: not Mist_Upgrade
              movement: mist1
      exits:
        - to: Passage Entrance
          req: Underwater_Movement and Amagi_Breach_Center_Ruins_Blocks
          movement: water
          jumps: 1
          penalties:
            - add: 1.5  # twists and turns
        - to: Cache
          req: Nanite_Mist
          movement: mist2
          penalties:
            - when: not Mist_Upgrade
              movement: mist1
        - to: Cache
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 3
    - name: Cache
      coord: [28.55, 18.0]
      local:
        - to: Passage Exit
          thru: [28.6, 18.1]
      locations:
        - name: Flask
          canon: Amagi_Breach_Center_Ruins_Flask
          item: Flask
          tags: [flask]
        - name: Flask Collection Skip
          canon: Amagi_Breach_Center_Ruins_Flask
          item: Flask
          to: Menu > Warp Only > Breach
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Amagi_Breach_Center_Ruins_Flask
          item: Flask
          req: Fast_Travel
          to: ^map_spot
          tags: [cskip]

- name: Upper Lake  # MARK: Upper Lake
  on_entry: $reset_old_area(^newpos)
  data:
    save_point: Save Point
    portal_start: Portal Stand
  map:
    save: [34, 14, 35, 15]
    health: [33, 14, 34, 15]
  datamap:
    map_spot:
      save: Menu > Breach Map > LAB Enclosed
      health: Menu > Breach Map > LAB Upper Lake Health
  spots:
    - name: Save Point
      coord: [34.475, 14.5]
      data:
        flipside: Amagi > East Lake > Center Above
      local:
        - to: Portal Stand
        - to: Center of Platform
        - to: Middle
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Portal Stand
      coord: [34.75, 14.7]
      data:
        flipside: Amagi > East Lake > Center Northeast Platform
      local:
        - to: Save Point
          jumps: 2
      exits:
        - to: Near Column
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
    - name: Center of Platform
      coord: [34.4, 14.65]
      data:
        flipside: Amagi > East Lake > Center Upper Platform
      local:
        - to: Save Point
          jumps: 1
        - to: Middle
    - name: Middle
      coord: [34.15, 14.75]
      data:
        flipside: Amagi > East Lake > Center West Platform
      local:
        - to: Center of Platform
          jumps: 1
        - to: Save Point
          jumps: 2
        - to: Near Column
    - name: Near Column
      coord: [33.8, 14.75]
      local:
        - to: Middle
        - to: Column
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Column
          req: Slingshot_Hook
          movement: base
          jumps: 1
    - name: Column
      coord: [33.5, 14.5]
      data:
        flipside: Amagi > East Lake > Far West Above
      local:
        - to: Near Column
      locations:
        - name: Health
          item: Health_Fragment
          tags: [standing]

- name: Fishy Secrets  # MARK: Fishy Secrets
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: North
      coord: [35.5, 18.2]
      local:
        - to: Northeast Corner
        - to: Northwest Ledge
      exits:
        - to: East Column > South
          tags: [ydoor]
    - name: Northeast Corner
      coord: [35.7, 18.5]
      data:
        flipside: Amagi > Secret Chamber > Upper Cache
      local:
        - to: North
          jumps: 1
          jump_mvmt: water
        - to: Northwest Ledge
    - name: Northwest Ledge
      coord: [34.4, 18.5]
      local:
        - to: North
          jumps: 1
          jump_mvmt: water
        - to: Northeast Corner
        - to: Middle West
    - name: Middle West
      coord: [34.45, 18.9]
      local:
        - to: South
          thru: [[34.65, 19.0], [34.65, 19.6]]
      exits:
        - to: Center Column
          req: Underwater_Movement and (Slingshot_Hook or Drone_Hover)
          movement: water
        - to: Center Column
          req: Slingshot_Hook or Drone_Hover
          movement: base
    - name: Center Column
      coord: [34.9, 18.9]
      data:
        flipside: Amagi > Secret Chamber > Column
      local:
        - to: South
        - to: East Pentomino
      exits:
        - to: Middle West
          req: Underwater_Movement and (Slingshot_Hook or Drone_Hover)
          movement: water
        - to: Middle West
          req: Slingshot_Hook or Drone_Hover
          movement: base
    - name: East Pentomino
      coord: [35.3, 18.9]
      data:
        flipside: Amagi > Secret Chamber > Middle Ledge
      local:
        - to: Center Column
        - to: East Corner
    - name: East Corner
      coord: [35.7, 19.1]
      data:
        flipside: Amagi > Secret Chamber > Enclosed Cache
      local:
        - to: East Pentomino
          jumps: 1
    - name: Shaft Bottom
      coord: [34.75, 19.75]
      data:
        flipside: Amagi > Secret Chamber > East Dur-Esla
      local:
        - to: Middle West
          jumps: 3
          jump_mvmt: water
        - to: Center Column
          jumps: 3
          jump_mvmt: water
      exits:
        - to: Center Column
          req: $mist2
          movement: mist2
        - to: Center Column
          req: Nanite_Mist
          movement: mist1
        - to: Center Column
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
        - to: Middle West
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
    - name: South
      coord: [34.5, 19.8]
      local:
        - to: Shaft Bottom
          jumps: 1
        - to: West
          jumps: 1
      exits:
        - to: Divided > North
          tags: [ydoor]
    - name: West
      coord: [34.1, 19.75]
      local:
        - to: South
      exits:
        - to: Split One-Way > East
          tags: [xdoor]

- name: Divided  # MARK: Divided
  on_entry: $reset_old_area(^newpos)
  data:
    save_point: Save Point
    portal_start: Portal Hole
  map:
    save: [35, 20, 36, 21]
  datamap:
    map_spot:
      save: Menu > Breach Map > LAB Southeast
  spots:
    - name: Portal Hole
      coord: [35.0, 20.3]
    - name: North
      coord: [34.5, 20.2]
      local:
        - to: Empty Plinth
      exits:
        - to: Fishy Secrets > South
          tags: [ydoor]
    - name: Empty Plinth
      coord: [34.5, 20.7]
      data:
        flipside: Amagi > Isolation > Save Point
      local:
        - to: North
          jumps: 2
          jump_mvmt: water
      exits:
        - to: North
          req: Slingshot_Hook
          movement: base
          jumps: 2
    - name: Wall East
      coord: [35.125, 20.75]
      data:
        flipside: Amagi > Isolation > Midway
      local:
        - to: South
      locations:
        - name: Health
          item: Health_Fragment
          tags: [standing]
    - name: South
      coord: [35.5, 20.8]
      local:
        - to: Wall East
          jumps: 1
        - to: Save Point
          jumps: 1
      exits:
        - to: Annuna Breach > Bridge > North
          tags: [ydoor]
    - name: Save Point
      coord: [35.625, 20.7]
      data:
        flipside: Amagi > Isolation > Empty Plinth
      local:
        - to: South
      actions:
        - name: Save
          do: $save
          tags: [save]

- name: West Entrance  # MARK: West Entrance
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: North
      coord: [25.5, 14.2]
      local:
        - to: South
      exits:
        - to: Ebih Breach > Lake Gate > South
          tags: [ydoor]
    - name: South
      coord: [25.5, 15.8]
      local:
        - to: North
          jumps: 3
          jump_mvmt: water
      exits:
        - to: West Ruins > North
          tags: [ydoor]
        - to: North
          req: $mist2
          movement: mist2

- name: West Ruins  # MARK: West Ruins
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [26, 17, 27, 18]
    health: [27, 17, 28, 18]
  datamap:
    map_spot:
      flask: Menu > Breach Map > LAB West Ruins Flask
      health: Menu > Breach Map > LAB West Ruins Health
  spots:
    - name: North
      coord: [25.5, 16.2]
      local:
        - to: West Platform Hook Point
        - to: Bottom Middle
      exits:
        - to: West Platform
          req: Underwater_Movement and (Slingshot_Hook or Drone_Hover)
          movement: water
        - to: West Platform
          req: Slingshot_Hook or Drone_Hover
          movement: base
    - name: West Platform
      coord: [25.8, 16.75]
      local:
        - to: Bottom Middle
      exits:
        - to: Center Platform West
          req: Underwater_Movement and (Slingshot_Hook or Drone_Hover)
          movement: water
        - to: Center Platform West
          req: Slingshot_Hook or Drone_Hover
          movement: base
        - to: North
          req: $mist2
          movement: mist2
    - name: West Platform Hook Point
      coord: [25.65, 16.8]
      exits:
        - to: West Platform
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 1
        - to: West Platform
          req: Slingshot_Hook
          movement: base
          jumps: 1
        - to: Center Platform
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
    - name: Center Platform West
      coord: [26.25, 17.1]
      local:
        - to: Center Platform
        - to: Bottom Middle
      exits:
        - to: West Platform
          req: Underwater_Movement and (Slingshot_Hook or Drone_Hover)
          movement: water
          jumps: 1
        - to: West Platform
          req: Slingshot_Hook or Drone_Hover
          movement: base
          jumps: 2
    - name: Center Platform
      coord: [26.45, 17.1]
      data:
        flipside: Amagi > West Lake > East Platform
      local:
        - to: Bottom Middle
        - to: Button
        - to: Gate West
        - to: Center Platform West
      locations:
        - name: Flask
          canon: Amagi_Breach_West_Ruins_Flask
          item: Flask
          tags: [flask]
        - name: Flask Collection Skip
          canon: Amagi_Breach_West_Ruins_Flask
          item: Flask
          to: Menu > Warp Only > Breach
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Amagi_Breach_West_Ruins_Flask
          item: Flask
          to: ^map_spot
          tags: [cskip]
    - name: Bottom Middle
      coord: [26.25, 17.75]
      data:
        flipside: Amagi > West Lake > Mid-water Above Gap
      local:
        - to: Button
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Button
          req: Slingshot_Hook
          movement: base
          jumps: 1
        - to: Center Platform West
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
    - name: Button
      coord: [26.8, 17.4]
      local:
        - to: Bottom Middle
        - to: Gate West
          jumps: 1
        - to: Center Platform
          jumps: 1
          jump_mvmt: water
      locations:
        - name: Hit Button
          item: Amagi_Breach_West_Ruins_Gate
          tags: [button]
      exits:
        - to: East Platform
          req: Amagi_Breach_West_Ruins_Gate and Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
        - to: East
          req: Amagi_Breach_West_Ruins_Gate and Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
    - name: Gate West
      coord: [26.9, 17.35]
      local:
        - to: Button
        - to: Center Platform
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Gate East
          req: Amagi_Breach_West_Ruins_Gate and Underwater_Movement
          movement: water
        - to: Gate East
          req: Amagi_Breach_West_Ruins_Gate
          movement: base
        - to: Center Platform
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 2
        - to: Center Platform West
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 2
    - name: Gate East
      coord: [27.1, 17.35]
      local:
        - to: East
        - to: East Platform
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Gate West
          req: Amagi_Breach_West_Ruins_Gate and Underwater_Movement
          movement: water
        - to: Gate West
          req: Amagi_Breach_West_Ruins_Gate
          movement: base
        - to: Center Platform
          req: Amagi_Breach_West_Ruins_Gate and Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 2
        - to: Center Platform West
          req: Amagi_Breach_West_Ruins_Gate and Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 2
        - to: Bottom Middle
          req: Amagi_Breach_West_Ruins_Gate and Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 2
    - name: East Platform
      coord: [27.55, 17.3]
      local:
        - to: East
      locations:
        - name: Health
          item: Health_Fragment
          tags: [standing]
      exits:
        - to: Gate East
          req: Underwater_Movement or Slingshot_Hook
          movement: water
        - to: Gate East
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
    - name: East
      coord: [27.9, 17.75]
      local:
        - to: Gate East
          jumps: 1
          jump_mvmt: water
      exits:
        - to: East Platform
          req: Slingshot_Hook
          movement: base
          jumps: 2
        - to: East Platform
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2

- name: Twisty Passages  # MARK: Twisty Passages
  on_entry: $reset_old_area(^newpos)
  map:
    flask: [29, 20, 30, 21]
  datamap:
    map_spot:
      flask: Menu > Breach Map > LAB Twisty Passages Flask
  spots:
    - name: South
      coord: [28.5, 20.8]
      data:
        flipside: Amagi > Wiggly Room > South
      local:
        - to: West Flora
          jumps: 1
      exits:
        - to: Corner > North
          tags: [ydoor]
    - name: West Flora
      coord: [28.7, 20.7]
      data:
        flipside: Amagi > Wiggly Room > Gate East
      local:
        - to: South
      exits:
        - to: East Bottom
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          time: 30  # ? probably bad
    - name: Closed Chamber
      coord: [29.95, 20.9]
      data:
        flipside: Amagi > Wiggly Room > East Chamber
      locations:
        - name: Flask
          canon: Amagi_Breach_Twisty_Passages_Flask
          item: Big_Flask
          tags: [flask]
        - name: Flask Collection Skip
          canon: Amagi_Breach_Twisty_Passages_Flask
          item: Big_Flask
          to: Menu > Warp Only > Breach
          tags: [cskip]
        - name: Flask Fast Travel
          canon: Amagi_Breach_Twisty_Passages_Flask
          item: Big_Flask
          to: ^map_spot
          tags: [cskip]
    - name: East Bottom
      coord: [30.5, 20.6]
      data:
        flipside: Amagi > Wiggly Room > East Bottom
      exits:
        - to: East Bottom
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          time: 30  # ? probably bad
        - to: East Ledge
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 2
        - to: East Ledge
          req: $mist2
          movement: mist2
        - to: East Ledge
          req: Nanite_Mist
          movement: mist1
        - to: East
          req: $mist2
          movement: mist2
        - to: East
          req: Nanite_Mist
          movement: mist1
    - name: East Ledge
      coord: [30.5, 20.0]
      local:
        - to: East Bottom
      exits:
        - to: East
          req: Underwater_Movement and Drone_Hover
          movement: water
          jumps: 1
        - to: East
          req: Drone_Hover
          movement: base
          jumps: 1
        - to: North
          req: Underwater_Movement and Slingshot_Hook
          movement: water
          jumps: 3
        - to: North
          req: $mist2
          movement: mist2
        - to: North
          req: Nanite_Mist
          movement: mist1
    - name: North
      coord: [30.5, 19.2]
      local:
        - to: East Ledge
      exits:
        - to: Center Ruins > South
          tags: [ydoor]
    - name: East
      coord: [30.9, 19.75]
      local:
        - to: East Bottom
      exits:
        - to: East Ledge
          req: Underwater_Movement
          movement: water
        - to: East Ledge
          req: Slingshot_Hook or Drone_Hover
          movement: base
        - to: Lower Hallway > West
          tags: [xdoor]

- name: Lower Hallway  # MARK: Lower Hallway
  on_entry: $reset_old_area(^newpos)
  map:
    halusan: [31, 19, 32, 20]
  datamap:
    map_spot:
      halusan: Menu > Breach Map > Halusan
  spots:
    - name: West
      coord: [31.1, 19.75]
      data:
        flipside: Amagi > Divided Room > Upper Left Corner
      local:
        - to: West Ledge
          jumps: 1
      exits:
        - to: Twisty Passages > East
          tags: [xdoor]
        - to: Middle Bubbles
          req: Amagi_Breach_Lower_Hallway_Gate and Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
        - to: West Ledge
          req: Underwater_Movement and Slingshot_Hook
          movement: fast_hover
          jumps: 1
    - name: West Ledge
      coord: [31.3, 19.55]
      data:
        flipside: Amagi > Divided Room > Portal West
      local:
        - to: West
      exits:
        - to: Cache
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate
          movement: water
          jumps: 1
        - to: Cache
          req: Amagi_Breach_Lower_Hallway_Gate
          movement: base
          jumps: 1
        - to: Cache
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate and Slingshot_Hook
          movement: fast_hover
          jumps: 1
        - to: Middle Bubbles
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
    - name: Cache
      coord: [31.5, 19.4]
      data:
        flipside: Amagi > Divided Room > Portal Stand
      locations:
        - name: Item
          item: Halusan
          tags: [standing]
        - name: Hit Button
          item: Amagi_Breach_Lower_Hallway_Gate
          tags: [button]
      exits:
        - to: West Ledge
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate
          movement: water
        - to: West Ledge
          req: Amagi_Breach_Lower_Hallway_Gate
          movement: base
        - to: Empty Plinth
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate
          movement: water
        - to: Empty Plinth
          req: Amagi_Breach_Lower_Hallway_Gate
          movement: base
    - name: Empty Plinth
      coord: [31.75, 19.4]
      data:
        flipside: Amagi > Divided Room > Portal East Mid-air
      local:
        - to: East Ledge
        - to: Middle Bubbles
      exits:
        - to: Cache
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate and Slingshot_Hook
          movement: fast_hover
        - to: Cache
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate
          movement: water
        - to: Cache
          req: Amagi_Breach_Lower_Hallway_Gate
          movement: base
        - to: West
          req: Underwater_Movement and Amagi_Breach_Lower_Hallway_Gate and Slingshot_Hook and Drone_Hover
          movement: fast_hover
    - name: East Ledge
      coord: [31.8, 19.55]
      data:
        flipside: Amagi > Divided Room > Portal East
      local:
        - to: Empty Plinth
          jumps: 1
        - to: Middle Bubbles
      exits:
        - to: Empty Plinth
          req: Slingshot_Hook
          movement: fast_hover
          jumps: 1
    - name: Middle Bubbles
      coord: [31.9, 19.7]
      data:
        flipside: Amagi > Divided Room > Upper Right Corner
      local:
        - to: Empty Plinth
          jumps: 1
          jump_mvmt: water
        - to: East Ledge
          jumps: 1
        - to: East
          jumps: 2
      exits:
        - to: Empty Plinth
          req: Underwater_Movement and Slingshot_Hook
          movement: fast_hover
          jumps: 1
    - name: East
      coord: [32.9, 19.75]
      local:
        - to: Middle Bubbles
          jumps: 2
      exits:
        - to: Split One-Way > West 20
          tags: [xdoor]

- name: Upper Hallway  # MARK: Upper Hallway
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West
      coord: [31.1, 18.65]
      local:
        - to: West Hook Point
      exits:
        - to: Center Ruins > East 19
          tags: [xdoor]
    - name: West Hook Point
      coord: [31.45, 18.75]
      data:
        flipside: Amagi > Grid 31,19 > Center
      local:
        - to: West
          jumps: 1
        - to: Column West
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Column West
          req: Slingshot_Hook
          movement: base
          jumps: 1
        - to: Column West
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          jumps: 1
        # TODO: fast_hover into Center Ruins
    - name: Column West
      coord: [32.45, 18.4]
      local:
        - to: West Hook Point
        - to: Column East
        - to: North
          jumps: 1
      exits:
        - to: Split One-Way > Upper Middle
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
          penalty_tags: [xdoor, -fast_hover.2]
    - name: Column East
      coord: [32.55, 18.4]
      local:
        - to: Column West
        - to: North
          jumps: 1
        - to: East
      exits:
        - to: West Hook Point
          req: Underwater_Movement and Slingshot_Hook and Drone_Hover
          movement: fast_hover
    - name: North
      coord: [32.5, 18.2]
      local:
        - to: West Hook Point
        - to: Column West
        - to: Column East
        - to: East
      exits:
        - to: East Ruins > South
          tags: [ydoor]
    - name: East
      coord: [32.9, 18.65]
      local:
        - to: Column East
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Column East
          req: Slingshot_Hook
          movement: base
          jumps: 1
        - to: Split One-Way > West 19
          tags: [xdoor]

- name: Split One-Way  # MARK: Split One-Way
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West 19
      coord: [33.1, 18.65]
      local:
        - to: Upper Middle
          jumps: 1
      exits:
        - to: Upper Hallway > East
          tags: [xdoor]
    - name: Upper Middle
      coord: [33.45, 18.6]
      local:
        - to: West 19
      exits:
        - to: Column
          req: Underwater_Movement and Drone_Hover
          movement: water
          jumps: 2
        - to: Column
          req: $mist2
          movement: mist2
        - to: Column
          req: Nanite_Mist
          movement: mist1
    - name: Column
      coord: [33.6, 18.5]
      local:
        - to: East Ledge
        - to: Lower Ledge
          thru: [33.7, 19.1]
      exits:
        - to: West 19
          req: Underwater_Movement and Drone_Hover
          movement: water
        - to: West 19
          req: Drone_Hover
          movement: base
    - name: East Ledge
      coord: [33.8, 19.0]
      local:
        - to: Lower Ledge
      exits:
        - to: Column
          req: Underwater_Movement and Drone_Hover
          movement: water
          jumps: 3
        - to: Column
          req: $mist2
          movement: mist2
        - to: Column
          req: Nanite_Mist
          movement: mist1
    - name: Lower Ledge
      coord: [33.35, 19.35]
      local:
        - to: West 20
        - to: Gate West
        - to: East Ledge
          jumps: 1
          jump_mvmt: water
      exits:
        - to: East Ledge
          req: Slingshot_Hook
          movement: base
          jumps: 2
    - name: West 20
      coord: [33.1, 19.75]
      local:
        - to: Gate West
        - to: Lower Ledge
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Lower Hallway > East
          tags: [xdoor]
        - to: Lower Ledge
          req: $mist2
          movement: mist2
        - to: Lower Ledge
          req: Nanite_Mist
          movement: mist1
    - name: Gate West
      coord: [33.4, 19.75]
      local:
        - to: West 20
        - to: Lower Ledge
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Lower Ledge
          req: $mist2
          movement: mist2
        - to: Lower Ledge
          req: Nanite_Mist
          movement: mist1
        - to: Button
          req: Underwater_Movement and Amagi_Breach_Split_Gate
          movement: water
        - to: Button
          req: Amagi_Breach_Split_Gate
          movement: base
    - name: Button
      coord: [33.675, 19.75]
      local:
        - to: East
      locations:
        - name: Hit Button
          item: Amagi_Breach_Split_Gate
          tags: [button]
      exits:
        - to: Gate West
          req: Underwater_Movement and Amagi_Breach_Split_Gate
          movement: water
        - to: Gate West
          req: Amagi_Breach_Split_Gate
          movement: base
    - name: East
      coord: [33.9, 19.75]
      local:
        - to: Button
      exits:
        - to: Fishy Secrets > West
          tags: [xdoor]

- name: Corner  # MARK: Corner
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: North
      coord: [28.5, 21.2]
      data:
        flipside: Uhrum > Tulip Tower > North
      local:
        - to: East
      exits:
        - to: Twisty Passages > South
          tags: [ydoor]
    - name: East
      coord: [28.9, 21.75]
      local:
        - to: North
          thru: [28.65, 21.8]
          jumps: [0, 2]
          jump_mvmt: water
      exits:
        - to: Lakebed > West
          tags: [xdoor]

- name: Lakebed  # MARK: Lakebed
  on_entry: $reset_old_area(^newpos)
  data:
    save_point: Save Point
  map:
    save: [30, 22, 31, 23]
  datamap:
    map_spot:
      save: Menu > Breach Map > LAB Southwest
  spots:
    - name: West
      coord: [29.1, 21.75]
      local:
        - to: Big Rock West
        - to: East Rock Middle
        - to: Save Point
      exits:
        - to: Corner > East
          tags: [xdoor]
    - name: Big Rock West
      coord: [29.2, 21.95]
      data:
        flipside: Annuna > Invisible Enemies > Corner Cache
      local:
        - to: West
          jumps: 1
        - to: East Rock Middle
        - to: Save Point
    - name: East Rock Middle
      coord: [29.3, 22.25]
      data:
        flipside: Annuna > Invisible Enemies > Shock Distance
      local:
        - to: Big Rock West
          jumps: 2
        - to: Lower East Ledge
    - name: Lower East Ledge
      coord: [29.5, 22.4]
      data:
        flipside: Annuna > Invisible Enemies > Switch Above
      local:
        - to: Bottom
        - to: East Rock Middle
          jumps: 1
    - name: Bottom
      coord: [29.75, 22.8]
      data:
        flipside: Annuna > Invisible Enemies > Switch East
      local:
        - to: Save Point
          jumps: 4
        - to: Lower East Ledge
          jumps: 1
          jump_mvmt: water
      exits:
        - to: Lower East Ledge
          req: Slingshot_Hook
          movement: base
          jumps: 2
    - name: Save Point
      coord: [30.475, 22.15]
      data:
        flipside: Annuna > Invisible Enemies > Portal Stand
      local:
        - to: Bottom
        - to: Big Rock West
          jumps: 2
          jump_mvmt: water
      exits:
        - to: Big Rock West
          req: Drone_Hover
          movement: base
          jumps: 2
      actions:
        - name: Save
          do: $save
          tags: [save]
