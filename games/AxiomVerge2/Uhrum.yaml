name: Uhrum Valley
short: Uhrum

areas:
- name: West Entrance
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West 27
      coord: [19.05, 26.8]
      local:
        - to: Southeast Tree
      exits:
        - to: Irikar > Lamassu > East 27
          tags: [xshift]
        - to: South Platform
          req: $hover
          movement: base
    - name: West 26
      coord: [19.05, 25.85]
      local:
        - to: Middle West Ledge
      exits:
        - to: Irikar > Lamassu > East 26
          tags: [xshift]
        - to: Hidden Passage Entry
          req: $hook
          movement: base
          jumps: 3
        - to: Portal Stand
          req: $grab and $climb
          movement: base
          jumps: 3
        - to: Portal Stand
          req: $hook
          jumps: 2

    - name: Hidden Passage West
      coord: [19.05, 25.2]
      local:
        - to: Hidden Passage Entry
      exits:
        - to: Irikar > Lamassu > Hidden Passage East
          tags: [xshift]
    - name: Hidden Passage Entry
      coord: [19.2, 25.2]
      local:
        - to: Hidden Passage West
        - to: Portal Stand
        - to: Middle West Ledge
        - to: West 26
          thru: [19.225, 25.6]
    - name: West 25
      coord: [19.05, 24.75]
      local:
        - to: Top West Ledge
      exits:
        - to: Giguna > Separator > East 25
          tags: [xshift]
    - name: Top West Ledge
      coord: [19.2, 24.9]
      local:
        - to: Portal Stand
        - to: Middle West Ledge
      exits:
        - to: Hidden Passage Entry
          req: ^mode == 'drone'
          movement: base
        - to: West of Gate
          req: $hover
          movement: base
    - name: Middle West Ledge
      coord: [19.3, 26.5]
      local:
        - to: Southeast Tree
        - to: South Platform
        - to: Save Point
      exits:
        - to: Portal Stand
          req: $grab and $climb
          movement: base
          jumps: 7
        - to: Portal Stand
          req: $hook
          movement: base
          jumps: 4

    - name: Southeast Tree
      coord: [19.2, 27.05]
      enter:
        map_uhrum_west_entrance_save: true
      local:
        - to: Save Point
        - to: West 27
          jumps: 2
      exits:
        - to: South Platform
          req: $hook
          movement: base
          jumps: 1
    - name: South Platform
      coord: [19.45, 26.8]
      local:
        - to: Southeast Tree
        - to: Save Point
        - to: Lower Wall West
      exits:
        - to: Middle West Ledge
          req: $hook
          movement: base
          jumps: 2
        - to: West 27
          req: $hover
          movement: base

    - name: Save Point
      coord: [19.5, 27.35]
      enter:
        map_uhrum_west_entrance_save: true
      local:
        - to: Southeast Tree
          jumps: 2
      exits:
        - to: South Platform
          req: $hook
          movement: base
          jumps: 2
        - to: Lower Wall West
          req: $grab
          movement: base
          jumps: 4
        - to: Lower Wall West
          req: $hook
          movement: base
          jumps: 2
      actions:
        - name: Save
          do: $save
          tags: [save]
    - name: Portal Stand
      coord: [19.525, 25.5]
      local:
        - to: West 26
        - to: Middle West Ledge
        - to: Clear Passage
      exits:
        - to: Hidden Passage Entry
          req: $hook
          movement: base
          jumps: 1
        - to: West of Gate
          req: $grab
          movement: base
          jumps: 3
        - to: West of Gate
          req: $hook
          movement: base
          jumps: 2
    - name: Clear Passage
      coord: [19.95, 25.75]
      local:
        - to: Upper Fork
          jumps: 1
        - to: East 26
      exits:
        - to: Portal Stand
          req: $grab and $climb
          movement: base
          jumps: 4
        - to: Portal Stand
          req: $hook
          movement: base
          jumps: 2

    - name: West of Gate
      coord: [19.65, 25.1]
      local:
        - to: Portal Stand
      exits:
        - to: Top West Ledge
          req: $hover
          movement: base
          jumps: 1
        - to: Top West Ledge
          req: $hook  # possible?
          movement: base
          jumps: 2
        - to: Inner Dais
          req: Uhrum_West_Entrance_Gate
          movement: base
          jumps: 2
    - name: Inner Dais
      coord: [19.95, 24.8]
      local:
        - to: Upper Wall West
        - to: Portal Exit
          jumps: 3
      locations:
        - name: Item
          item: Udusan
          tags: [standing]
      exits:
        - to: West of Gate
          req: Uhrum_West_Entrance_Gate
          movement: base
        - to: Top West Ledge
          req: Uhrum_West_Entrance_Gate and $hover
          movement: base
    - name: Portal Exit
      coord: [20.525, 24.6]
      local:
        - to: Inner Dais
        - to: Gate Switch
        - to: Upper Wall West
          thru: [20.3, 24.9]
    - name: Gate Switch
      coord: [20.6, 24.7]
      local:
        - to: Portal Exit
          jumps: 1
      locations:
        - name: Open Gate
          item: Uhrum_West_Entrance_Gate
          req: $can_damage
          time: 0.25  # ?

    - name: Upper Wall West
      coord: [20.3, 25.2]
      local:
        - to: Inner Dais
          jumps: 2
      exits:
        - to: Portal Exit
          req: $grab
          movement: base
          jumps: 2
        - to: Portal Exit
          req: $hook
          movement: base
          jumps: 1
        - to: Upper Wall East
          req: Uhrum_West_Entrance_Upper_Wall
          movement: base
      hybrid:
        - name: Mist through Wall
          item: Uhrum_West_Entrance_Upper_Wall
          canon: Uhrum_West_Entrance_Upper_Wall
          req: $mist2
          to: Upper Wall East
          price: 20
    - name: Upper Wall East
      coord: [20.45, 25.3]
      local:
        - to: Upper Fork
      exits:
        - to: Upper Wall West
          req: Uhrum_West_Entrance_Upper_Wall
          movement: base
          jumps: 1
      hybrid:
        - name: Charge through Wall
          item: Uhrum_West_Entrance_Upper_Wall
          canon: Uhrum_West_Entrance_Upper_Wall
          req: $charge
          to: Upper Wall West
          time: 1  # ?
        - name: Spin through Wall
          item: Uhrum_West_Entrance_Upper_Wall
          canon: Uhrum_West_Entrance_Upper_Wall
          req: $spin
          to: Upper Wall West
          time: 0.3
        - name: Mist through Wall
          item: Uhrum_West_Entrance_Upper_Wall
          canon: Uhrum_West_Entrance_Upper_Wall
          req: $mist2
          to: Upper Wall West
          price: 20
          movement: mist2
    - name: Upper Fork
      coord: [20.55, 25.6]
      local:
        - to: Clear Passage
        - to: East 26
      exits:
        - to: Upper Wall East
          req: $hook
          movement: base
          jumps: 1
        - to: Upper Wall East
          req: $mist2
          price: 30
          movement: mist2
    - name: East 26
      coord: [20.95, 25.8]
      local:
        - to: Upper Fork
          jumps: 1
        - to: Clear Passage
      exits:
        - to: Siege Corridor > West 26
          tags: [xshift]

    - name: Lower Wall West
      coord: [19.85, 26.9]
      enter:
        # close enough
        map_uhrum_west_entrance_save: true
      local:
        - to: Save Point
      exits:
        - to: South Platform
          req: $hover
          movement: base
          jumps: 1
        - to: South Platform
          req: $hook
          movement: base
          jumps: 1
        - to: South Platform
          req: $grab
          movement: base
          jumps: 2
        - to: Lower Wall East
          req: Uhrum_West_Entrance_Lower_Wall
          movement: base
          jumps: 1
      hybrid:
        - name: Charge through Wall
          item: Uhrum_West_Entrance_Lower_Wall
          canon: Uhrum_West_Entrance_Lower_Wall
          req: $charge
          to: Lower Wall East
          time: 1.2  # ?
        - name: Spin through Wall
          item: Uhrum_West_Entrance_Lower_Wall
          canon: Uhrum_West_Entrance_Lower_Wall
          req: $spin
          to: Lower Wall East
          time: 0.5  # ?
        - name: Mist through Wall
          item: Uhrum_West_Entrance_Lower_Wall
          canon: Uhrum_West_Entrance_Lower_Wall
          req: $mist2
          to: Lower Wall East
          price: 40
          movement: mist2
    - name: Lower Wall East
      coord: [20.1, 26.8]
      local:
        - to: Lower Path Rock
        - to: Lower Path Gap
      exits:
        - to: Lower Wall West
          req: Uhrum_West_Entrance_Lower_Wall
          movement: base
      hybrid:
        - name: Charge through Wall
          item: Uhrum_West_Entrance_Lower_Wall
          canon: Uhrum_West_Entrance_Lower_Wall
          req: $charge
          to: Lower Wall West
          time: 1.2  # ?
        - name: Spin through Wall
          item: Uhrum_West_Entrance_Lower_Wall
          canon: Uhrum_West_Entrance_Lower_Wall
          req: $spin
          to: Lower Wall West
          time: 0.5  # ?
        - name: Mist through Wall
          item: Uhrum_West_Entrance_Lower_Wall
          canon: Uhrum_West_Entrance_Lower_Wall
          req: $mist2
          to: Lower Wall West
          price: 40
          movement: mist2
    - name: Lower Path Rock
      coord: [20.3, 26.9]
      local:
        - to: Lower Path Gap
        - to: Lower Path Tree Ledge
        - to: Lower Wall East
          jumps: 1
    - name: Lower Path Gap
      coord: [20.2, 27.3]
      local:
        - to: Sand
      exits:
        - to: Lower Wall West
          req: $hook
          movement: base
          jumps: 2
        - to: Lower Path Tree Ledge
          req: $hook
          movement: base
          jumps: 1
    - name: Sand
      coord: [20.0, 27.75]
      locations:
        - name: Refill
          item: Refill
          req: $more_refills
          tags: [standing]
      exits:
        - to: Lower Path Gap
          req: $hook
          movement: base
          jumps: 2
        - to: Lower Path Tree Ledge
          req: $hook
          movement: base
          jumps: 2
        - to: Lower Path Tree Ledge
          req: $grab and $climb
          movement: base
          jumps: 3
    - name: Lower Path Tree Ledge
      coord: [20.55, 27.3]
      local:
        - to: Sand
        - to: Lower Path Rock
          jumps: 3
        - to: East 28
    - name: East 28
      coord: [20.95, 27.7]
      exits:
        - to: Lower Path Tree Ledge
          req: $grab
          movement: base
          jumps: 3
        - to: Lower Path Tree Ledge
          req: $hook
          movement: base
          jumps: 2
        - to: Glitchy Corridor > West 28
          tags: [xshift]

- name: Siege Corridor
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West 26
      coord: [21.05, 25.8]
    - name: Western Cache
      coord: [21.1, 24.6]
    - name: Western Rock
      coord: [21.3, 25.0]
    - name: Northwest Door
      coord: [21.5, 24.2]
    - name: Northwest Platform
      coord: [21.75, 24.7]
    - name: West Greenery
      coord: [22.2, 25.35]
    - name: West Grassy Ledge
      coord: [22.3, 24.95]
    - name: West Rocky Ledge
      coord: [22.15, 24.75]
    - name: Center West
      coord: [23.0, 24.4]

    - name: Center Platform 1
      coord: [23.9, 24.7]
    - name: Center Platform 3
      coord: [24.4, 24.7]
    - name: Center East
      coord: [24.2, 24.95]
    - name: Center Box
      coord: [23.7, 25.5]
    - name: Mideast Hill
      coord: [24.5, 24.9]
    - name: Upper Rock West
      coord: [25.0, 24.4]
    - name: Upper Rock Item
      coord: [25.4, 24.35]
    - name: Upper Rock East
      coord: [25.55, 24.4]

    - name: Pond
      coord: [25.4, 25.5]
    - name: East Hill
      coord: [25.7, 24.7]
    - name: East 25
      coord: [25.95, 24.75]

- name: Glitchy Corridor
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West 28
      coord: [21.05, 27.7]

- name: Waterfalls
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West 25
      coord: [26.05, 24.75]
    - name: West 24
      coord: [26.05, 23.75]
    - name: West 27
      coord: [26.05, 26.75]

- name: Save Room
  on_entry: $reset_old_area(^newpos)
  map: save
  spots:
    - name: East
      coord: [25.95, 26.75]
    - name: Save Point
      coord: [25.5, 26.75]
    - name: West
      coord: [25.05, 26.75]

