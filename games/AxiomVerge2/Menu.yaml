name: Menu
data:
  realm: menu

areas:
- name: Upgrade Menu  # MARK: Upgrade Menu
  tags: [menu]
  spots:
    - name: Physiology
      locations:
        - name: Health Upgrade 1
          item: Health_Upgrade
          price: 1
          costs: flasks
        - name: Health Upgrade 2
          item: Health_Upgrade_2
          req: Health_Upgrade
          price: 2
          costs: flasks
        - name: Health Upgrade 3
          item: Health_Upgrade_3
          req: Health_Upgrade_2
          price: 4
          costs: flasks
        - name: Health Upgrade 4
          item: Health_Upgrade_4
          req: Health_Upgrade_3
          price: 4
          costs: flasks
        - name: Health Upgrade 5
          item: Health_Upgrade_5
          req: Health_Upgrade_4
          price: 6
          costs: flasks

        - name: Mist Upgrade
          item: Mist_Upgrade
          req: Nanite_Mist
          price: 5
          costs: flasks
      exits:
        - to: Combat
          time: 0.1
        - to: Infection
          req: Infect
          time: 0.1
        - to: Drone
          req: Remote_Drone
          time: 0.1
    - name: Combat
      locations:
        - name: Melee Damage 1
          item: Melee_Damage
          price: 1
          costs: flasks
        - name: Melee Damage 2
          item: Melee_Damage_2
          req: Melee_Damage
          price: 4
          costs: flasks
        - name: Melee Damage 3
          item: Melee_Damage_3
          req: Melee_Damage_2
          price: 6
          costs: flasks
        - name: Melee Speed 1
          item: Melee_Speed
          price: 1
          costs: flasks
        - name: Melee Speed 2
          item: Melee_Speed_2
          req: Melee_Speed
          price: 4
          costs: flasks
        - name: Melee Speed 3
          item: Melee_Speed_3
          req: Melee_Speed_2
          price: 6
          costs: flasks
        - name: Ranged Damage 1
          item: Ranged_Damage
          price: 1
          costs: flasks
        - name: Ranged Damage 2
          item: Ranged_Damage_2
          req: Ranged_Damage
          price: 4
          costs: flasks
        - name: Ranged Damage 3
          item: Ranged_Damage_3
          req: Ranged_Damage_2
          price: 6
          costs: flasks
        - name: Ranged Speed 1
          item: Ranged_Speed
          price: 1
          costs: flasks
        - name: Ranged Speed 2
          item: Ranged_Speed_2
          req: Ranged_Speed
          price: 3
          costs: flasks
        - name: Ranged Speed 3
          item: Ranged_Speed_3
          req: Ranged_Speed_2
          price: 5
          costs: flasks
      exits:
        - to: Physiology
          time: 0.1
        - to: Infection
          req: Infect
          time: 0.1
        - to: Drone
          req: Remote_Drone
          time: 0.1
    - name: Infection
      locations:
        - name: Infection Level 1
          item: Infect_L1
          price: 1
          costs: flasks
        - name: Infection Level 2
          item: Infect_L2
          req: Infect_L1
          price: 3
          costs: flasks
        - name: Infection Level 3
          item: Infect_L3
          req: Infect_L2
          price: 4
          costs: flasks
        - name: Nano Points 1
          item: Nano_Points
          price: 1
          costs: flasks
        - name: Nano Points 2
          item: Nano_Points_2
          req: Nano_Points
          price: 3
          costs: flasks
        - name: Nano Points 3
          item: Nano_Points_3
          req: Nano_Points_2
          price: 5
          costs: flasks
        - name: Infection Speed 1
          item: Infection_Speed
          price: 2
          costs: flasks
        - name: Infection Speed 2
          item: Infection_Speed_2
          req: Infection_Speed
          price: 5
          costs: flasks
        - name: Infection Range 1
          item: Infection_Range
          price: 1
          costs: flasks
        - name: Infection Range 2
          item: Infection_Range_2
          req: Infection_Range
          price: 3
          costs: flasks
        - name: Infection Range 3
          item: Infection_Range_3
          req: Infection_Range_2
          price: 5
          costs: flasks
      exits:
        - to: Physiology
          time: 0.1
        - to: Combat
          time: 0.1
        - to: Drone
          req: Remote_Drone
          time: 0.1
    - name: Drone
      locations:
        - name: Drone Melee Damage 1
          item: Drone_Melee_Damage
          price: 1
          costs: flasks
        - name: Drone Melee Damage 2
          item: Drone_Melee_Damage_2
          req: Drone_Melee_Damage
          price: 3
          costs: flasks
        - name: Drone Melee Damage 3
          item: Drone_Melee_Damage_3
          req: Drone_Melee_Damage_2
          price: 5
          costs: flasks
        - name: Drone Melee Speed 1
          item: Drone_Melee_Speed
          price: 1
          costs: flasks
        - name: Drone Melee Speed 2
          item: Drone_Melee_Speed_2
          req: Drone_Melee_Speed
          price: 3
          costs: flasks
        - name: Drone Melee Speed 3
          item: Drone_Melee_Speed_3
          req: Drone_Melee_Speed_2
          price: 5
          costs: flasks
        #- name: Drone Slingshot something
      exits:
        - to: Physiology
          time: 0.1
        - to: Combat
          time: 0.1
        - to: Infection
          req: Infect
          time: 0.1

- name: Warp Only  # MARK: Warp Only
  on_entry: $save_last
  # These spots allow savewarp only by tagging the appropriate realm and having no other way out
  tags: [cskip, menu]
  spots:
    - name: Kiengir
      data:
        realm: main
    - name: Breach
      data:
        realm: breach

## Fast travel maps
# These areas are representations of moving on the map.
# TODO: Fast travel times are slightly different (faster) when travelling within an area
# TODO: under some conditions, fast travel indra can appear standing up
# 7s. I think it's immediately after savewarping/fast travelling though, so not very useful.
# there's a similar trick opening the map as you die, you can fast travel in the middle of your respawn
# that's only useful for changing your active/passive room? bleh
- name: Kiengir Map  # MARK: Kiengir Map
  on_entry: $save_last
  data:
    realm: map
  tags: [map]
  graph_attrs: "shape=doublecircle, fillcolor=\"8\""
  graph_exclude_local_edges: true
  all:
    # We only need the fast travel locations specified here. Note self-edges are ignored.
    # These would otherwise be repeated on all spots.
    local:
      - to: Amagi East Lake
      - to: Amagi Isolation
      - to: Amagi Main Area
      - to: Annuna Center Save
      - to: Annuna Factory Entrance
      - to: Annuna Mirror Match
      - to: Annuna Upper
      - to: Annuna Vertical Room
      - to: Annuna West Bridge
      - to: Apocalypse
      - to: Ebih Base Camp
      - to: Ebih Observatory
      - to: Ebih West Lower
      - to: Ebih West Mid
      - to: Ebih West Upper
      - to: Giguna Base
      - to: Giguna Labyrinth
      - to: Giguna Northeast
      - to: Giguna Ruins Top
      - to: Giguna Ruins West
      - to: Giguna Separator
      - to: Glacier Revival
      - to: Irikar Beach Save
      - to: Irikar Hub
      - to: Irikar Midwest
      - to: Uhrum Center
      - to: Uhrum East
      - to: Uhrum Emergence
      - to: Uhrum West
  spots:
    #region Kiengir fast travel points
    - name: Amagi East Lake
      coord: [34, 18]
      exits:
        - to: Amagi > East Lake > Save Point
          req: ^map__amagi__east_lake__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Amagi Isolation
      coord: [34, 21]
    - name: Amagi Main Area
      coord: [29, 19]
      exits:
        - to: Amagi > Main Area > Save Point
          req: ^map__amagi__main_area__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Annuna Center Save
      coord: [39, 21]
      exits:
        - to: Annuna > Center Save > Save Point
          req: ^map__annuna__center_save__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Annuna Factory Entrance
      coord: [43, 25]
      exits:
        - to: Annuna > Factory Entrance > Save Point
          req: ^map__annuna__factory_entrance__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Annuna Mirror Match
      coord: [32, 26]
      exits:
        - to: Annuna > Mirror Match > Save Point
          req: ^map__annuna__mirror_match__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Annuna Upper
      coord: [39, 17]
      exits:
        - to: Annuna > Upper Save > Save Point
          req: ^map__annuna__upper_save__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Annuna Vertical Room
      coord: [40, 20]
      exits:
        - to: Annuna > Vertical Room > Save Point
          req: ^map__annuna__vertical_room__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Annuna West Bridge
      coord: [36, 27]
    - name: Apocalypse
      coord: [42, 17]
    - name: Ebih Base Camp
      coord: [29, 13]
      exits:
        - to: Ebih > Base Camp > Save Point
          req: ^map__ebih__base_camp__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Ebih Observatory
      coord: [21, 3]
    - name: Ebih West Lower
      coord: [19, 13]
      exits:
        - to: Ebih > Ebih West > Lower Save
          req: ^map__ebih__ebih_west__lower_save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Ebih West Mid
      coord: [20, 10]
      exits:
        - to: Ebih > Ebih West > Mid Save
          req: ^map__ebih__ebih_west__mid_save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Ebih West Upper
      coord: [20, 7]
      exits:
        - to: Ebih > Ebih West > Upper Save
          req: ^map__ebih__ebih_west__upper_save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Giguna Base
      coord: [13, 16]
      exits:
        - to: Giguna > Giguna Base > Save Point
          req: ^map__giguna__giguna_base__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Giguna Labyrinth
      coord: [17, 22]
    - name: Giguna Northeast
      coord: [17, 10]
      exits:
        - to: Giguna > Giguna Northeast > Save Point
          req: ^map__giguna__giguna_northeast__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Giguna Ruins Top
      coord: [14, 6]
      exits:
        - to: Giguna > Ruins Top > Save Point
          req: ^map__giguna__ruins_top__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Giguna Ruins West
      coord: [13, 9]
      exits:
        - to: Giguna > Ruins West > Save Point
          req: ^map__giguna__ruins_west__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Giguna Separator
      coord: [18, 25]
    - name: Glacier Revival
      coord: [41, 8]
      exits:
        - to: Glacier > Revival > Save Point
          req: ^map__glacier__revival__save
          time: 12
          penalties:
            - when: ^mode == 'drone'
              add: 2.5
          tags: [warp]
    - name: Irikar Beach Save
      coord: [5, 28]
    - name: Irikar Hub
      coord: [12, 23]
      exits:
        - to: Irikar > Hub > Save Point
          req: ^map__irikar__hub__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Irikar Midwest
      coord: [9, 25]
    - name: Uhrum Center
      coord: [25, 27]
      exits:
        - to: Uhrum > Save Room > Save Point
          req: ^map__uhrum__save_room__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Uhrum East
      coord: [28, 26]
      exits:
        - to: Uhrum > Annuna Corridor > Save Point
          req: ^map__uhrum__annuna_corridor__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    - name: Uhrum Emergence
      coord: [23, 22]
    - name: Uhrum West
      coord: [19, 28]
      exits:
        - to: Uhrum > West Entrance > Save Point
          req: ^map__uhrum__west_entrance__save
          time: 12
          penalties:
            - when: ^mode != 'drone'
              add: 2.5
          tags: [warp]
    #endregion

    #region Kiengir entry points (mostly items)
    # TODO: sort by coord?
    - name: Infect
      coord: [26, 9]
    - name: Remote Drone
      coord: [24, 6]
    - name: Breach Sight
      coord: [14, 26]
    - name: Shockwave
      coord: [23, 20]
    - name: Anuman
      coord: [29, 25]
    - name: Bronze Axe
      coord: [22, 10]

    - name: Filter Flask
      coord: [43, 21]
    - name: Filter Tablet
      coord: [44, 19]
    - name: Filter Spiders
      coord: [43, 19]
    - name: Breach Attractor
      coord: [37, 16]
    - name: Hammond
      coord: [40, 11]
    - name: Nanite Mist
      coord: [39, 15]
    - name: Apocalypse Cache
      coord: [42, 16]
    - name: Glacier Dock Flask
      coord: [44, 9]
    - name: Glacier 40,8
      coord: [40, 8]
    - name: Glacier Peak Bird's Eye
      coord: [34, 8]
    - name: Forbidden Knowledge
      coord: [35, 18]
    - name: Ebih Truck Gate
      coord: [25, 13]
    - name: Ebih Guarded Health
      coord: [21, 12]
    - name: Irikar Well
      coord: [12, 24]
    - name: Irikar 10,25
      coord: [10, 25]
    - name: Irikar Royal Storage
      coord: [12, 26]
    - name: Irikar Broken Wall
      coord: [11, 26]
    - name: Commemorative Speech
      coord: [13, 22]
    - name: The Student
      coord: [10, 27]
    - name: Irikar Abandoned Room
      coord: [14, 27]
    - name: Irikar Gudam
      coord: [15, 28]
    - name: Irikar Gudam Health
      coord: [15, 27]
    - name: Heretic's Granddaughter
      coord: [15, 25]
    - name: Terminal Breakthrough 2
      coord: [18, 26]
    - name: Irikar Mid-air Flask
      coord: [7, 23]
    #endregion

- name: Breach Map  # MARK: Breach Map
  on_entry: $save_last
  data:
    realm: map
  tags: [map]
  graph_offset: [0, 30]
  graph_attrs: "shape=doublecircle, fillcolor=\"8\""
  graph_exclude_local_edges: true
  all:
    local:
      - to: AGB Bridge Lower
      - to: AGB Bridge Upper
      - to: AGB East
      - to: AGB Enclosed
      - to: AGB North
      - to: AGB South
      - to: GlB Arena
      - to: GlB Center
      - to: GlB East
      - to: GlB South
      - to: GlB West
      - to: GSB East
      - to: GSB Emergence
      - to: GSB Labyrinth
      - to: GSB Peak
      - to: GSB SW Save
      - to: GSB South
      - to: IB Basement
      - to: IB Gauntlet
      - to: IB Save Room
      - to: IB West
      - to: LAB Center
      - to: LAB East
      - to: LAB Enclosed
      - to: LAB Southeast
      - to: LAB Southwest
      - to: MEB Drone
      - to: MEB Peak
      - to: MEB Southeast
      - to: MEB Southwest
      - to: UVB Center
      - to: UVB Dead-end
      - to: UVB East
      - to: UVB West
  spots:
    #region Breach fast travel points
    - name: AGB Bridge Lower
      coord: [35, 25]
    - name: AGB Bridge Upper
      coord: [34, 24]
    - name: AGB East
      coord: [42, 20]
    - name: AGB Enclosed
      coord: [42, 26]
    - name: AGB North
      coord: [37, 17]
    - name: AGB South
      coord: [41, 28]
    - name: GlB Arena
      coord: [39, 10]
      exits:
        - to: Glacier Breach > Save and Exit > Save Point
          req: ^map__glacier_breach__save_and_exit__save
          time: 12
          tags: [warp]
    - name: GlB Center
      coord: [35, 11]
      exits:
        - to: Glacier Breach > Guarded Corridor > Save Point
          req: ^map__glacier_breach__guarded_corridor__save
          time: 12
          tags: [warp]
    - name: GlB East
      coord: [40, 11]
      exits:
        - to: Glacier Breach > Hammond's Breach > Save Point
          req: ^map__glacier_breach__hammonds_breach__save
          time: 12
          tags: [warp]
    - name: GlB South
      coord: [38, 15]
      exits:
        - to: Glacier Breach > South Save > Save Point
          req: ^map__glacier_breach__south_save__save
          time: 12
          tags: [warp]
    - name: GlB West
      coord: [32, 12]
      exits:
        - to: Glacier Breach > West Save > Save Point
          req: ^map__glacier_breach__west_save__save
          time: 12
          tags: [warp]
    - name: GSB East
      coord: [20, 20]
    - name: GSB Emergence
      coord: [10, 9]
    - name: GSB Labyrinth
      coord: [16, 21]
    - name: GSB Peak
      coord: [15, 7]
      exits:
        - to: Giguna Breach > Peak > Save Point
          req: ^map__giguna_breach__peak__save
          time: 12
          tags: [warp]
    - name: GSB South
      coord: [19, 24]
    - name: GSB SW Save
      coord: [12, 12]
      exits:
        - to: Giguna Breach > SW Save > Save Point
          req: ^map__giguna_breach__sw_save__save
          time: 12
          tags: [warp]
    - name: IB Basement
      coord: [12, 28]
    - name: IB Gauntlet
      coord: [11, 22]
      exits:
        - to: Irikar Breach > Gauntlet > Save Point
          req: ^map__irikar_breach__gauntlet__save
          time: 12
          tags: [warp]
    - name: IB Save Room
      coord: [14, 26]
      exits:
        - to: Irikar Breach > Save Room > Save Point
          req: ^map__irikar_breach__save_room__save
          time: 12
          tags: [warp]
    - name: IB West
      coord: [9, 26]
    - name: LAB Center
      coord: [33, 17]
    - name: LAB East
      coord: [37, 16]
      exits:
        - to: Amagi Breach > East Entrance > Save Point
          req: ^map__amagi_breach__east_entrance__save
          time: 12
          tags: [warp]
    - name: LAB Enclosed
      coord: [34, 15]
    - name: LAB Southeast
      coord: [35, 21]
    - name: LAB Southwest
      coord: [30, 23]

    - name: MEB Drone
      coord: [24, 6]
    - name: MEB Peak
      coord: [24, 3]
    - name: MEB Southeast
      coord: [25, 13]
    - name: MEB Southwest
      coord: [19, 13]

    - name: UVB Center
      coord: [22, 28]
    - name: UVB Dead-end
      coord: [31, 26]
    - name: UVB East
      coord: [31, 27]
    - name: UVB West
      coord: [19, 26]
    #endregion

    #region Breach other entry points
    #endregion
