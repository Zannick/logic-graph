name: Irikar Breach
graph_offset: [0, 30]
data:
  breach: true

areas:
- name: Save Room
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: Save Point
      coord: [14.525, 25.35]
      data:
        flipside: Irikar > Sight Room > Portal
      local:
        - to: West
      # TODO: can we reach the map tile with hover alone? or need mist?
    - name: Upper Area
      coord: [14.5, 25.0]
      local:
        - to: Save Point
        - to: West
    - name: West
      coord: [14.1, 25.75]
      local:
        - to: Save Point
          jumps: 2
      exits:
        - to: Four-way > East
          tags: [xdoor]

- name: Gauntlet
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: Save Point
      coord: [11.3, 21.7]
      data:
        flipside: Irikar > Hub > Portal Stand
      local:
        - to: East 22
      exits:
        - to: Hidden Path Upper Entry
          req: $hover
          movement: base
          jumps: 1
        - to: Hidden Path Upper Entry
          req: $hook
          time: .85
    - name: East 22
      coord: [11.9, 21.8]
      local:
        - to: Save Point
          jumps: 2
      exits:
        - to: Hover Room > West
          tags: [xdoor]
    - name: Hidden Path Upper Entry
      coord: [11.6, 21.35]
      local:
        - to: Save Point
        - to: East 22
        - to: Hidden Path Upper Right
          jumps: 1
    - name: Hidden Path Upper Right
      coord: [11.55, 21.15]
      local:
        - to: Hidden Path Upper Entry
          jumps_down: 1
        - to: Hidden Path Upper Left
    - name: Hidden Path Upper Left
      coord: [10.25, 21.3]
      local:
        - to: Hidden Path Upper Right
          jumps: 1
        - to: Hidden Path Top Ledge
    - name: Hidden Path Top Ledge
      coord: [10.15, 21.7]
      local:
        - to: Hidden Path Upper Left
          jumps: 2
        - to: Hidden Path Reward
    - name: Hidden Path Reward
      coord: [10.05, 22.2]
      locations:
        - name: Item
          item: Flask
          tags: [flask]
      exits:
        - to: Hidden Path Top Ledge
          req: $hook
          movement: base
          jumps: 2
    - name: Hidden Path Bottom
      coord: [10.15, 24.55]
    - name: Hidden Path Lower Entry
      coord: [10.25, 24.55]

- name: Hover Room
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West
      coord: [12.1, 21.8]
      local:
        - to: Bottom
      exits:
        - to: East
          req: $hover
          movement: base
        - to: Gauntlet > East 22
          tags: [xdoor]
    - name: Bottom
      coord: [12.5, 22.75]
      locations:
        - name: Item
          item: Drone_Hover
          tags: [urn]
      exits:
        - to: West
          req: $hook
          time: 1.5  # ?
        - to: East
          req: $hook and $hover
          time: 3
    - name: East
      coord: [12.9, 21.8]
      local:
        - to: Bottom
      exits:
        - to: West
          req: $hover or $hook
          movement: base
        - to: Flappy Drone > West Door
          tags: [xdoor]

- name: Flappy Drone
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: West Door
      coord: [13.1, 21.8]
      local:
        - to: Initial Drop
      exits:
        - to: Hover Room > East
    - name: Initial Drop
      coord: [13.2, 22.3]
      local:
        - to: Upper Valley Left
        - to: Upper Valley Right
      exits:
        - to: Pillar Underside
          req: $hover
          movement: base
    - name: Pillar Underside
      coord: [13.3, 22.4]
      local:
        - to: Upper Valley Left
        - to: Upper Valley Right
      exits:
        - to: Top Pillar
          req: $hover and $hook
          time: 1  # ?
    - name: Upper Valley Left
      coord: [13.2, 22.55]
      local:
        - to: Upper Valley Right
        - to: Pillar Underside
          jumps: 1
    - name: Upper Valley Right
      coord: [13.4, 22.55]
      local:
        - to: Upper Valley Left
        - to: Pillar Underside
          jumps: 1
      exits:
        - to: Top Pillar
          req: $hover and $hook
          time: 2  # ?
    - name: Top Pillar
      coord: [13.45, 22.0]
      local:
        - to: Upper Valley Left
        - to: Upper Valley Right
        - to: Zigzag Bottom
          thru: [[13.6, 22.0], [13.6, 22.7], [13.45, 23.1], [13.525, 23.65], [13.525, 23.8]]
      exits:
        - to: Pillar Underside
          req: $hover
          movement: base
    - name: Zigzag Bottom
      coord: [13.3, 24.2]
      local:
        - to: Passage Corner
    - name: Passage Corner
      coord: [13.1, 24.2]
      local:
        - to: Side
        - to: Zigzag Bottom
        - to: South
          thru: [13.1, 24.4]
    - name: Side
      coord: [13.1, 24.55]
      local:
        - to: South
    - name: South
      coord: [13.5, 24.8]
      local:
        - to: Side
          jumps: 2
      exits:
        - to: Four-way > North
          tags: [ydoor]

- name: Four-way
  on_entry: $reset_old_area(^newpos)
  spots:
    - name: North
      coord: [13.5, 25.2]
    - name: South
      coord: [13.5, 25.8]
    - name: Ledge
      coord: [13.675, 25.35]
    - name: East
      coord: [13.9, 25.75]
    - name: West
      coord: [13.1, 25.3]