//! AUTOGENERATED FOR sample - MODIFICATIONS WILL BE LOST

#![allow(non_snake_case)]
#![allow(unused)]

use crate::graph::{self, *};
use crate::items::Item;
use crate::movements;
use crate::prices::Currency;
use crate::rules;
use analyzer::context;
use analyzer::world::World;
use enum_map::EnumMap;

pub mod enums {
    use std::fmt;
    #[derive(Debug, PartialEq, Eq, Copy, Clone, Hash, Ord, PartialOrd, Default)]
    pub enum Tod {
        #[default]
        Day,
        Night,
    }
    impl fmt::Display for Tod {
        fn fmt(&self, f: &mut fmt::Formatter) -> fmt::Result {
            match self {
                Tod::Day => write!(f, "{}", "Day"),
                Tod::Night => write!(f, "{}", "Night"),
            }
        }
    }
    impl std::str::FromStr for Tod {
        type Err = String;

        fn from_str(s: &str) -> Result<Self, Self::Err> {
            match s {
                "Day" => Ok(Tod::Day),
                "Night" => Ok(Tod::Night),
                _ => Err(format!("Could not recognize as a Tod: {}", s)),
            }
        }
    }
}

#[derive(Copy, Clone, Debug, Default, PartialEq, Eq)]
pub enum Status {
    #[default]
    None,
    Visited,
    Skipped,
}

#[derive(Clone, Debug, Eq, PartialEq)]
pub struct Context {
    // context vars
    pub position: SpotId,
    pub save: SpotId,
    pub child: bool,
    pub tod: enums::Tod,
    pub rupees: i32,
    pub deku_tree__compass_room__ctx__torch: bool,
    // settings
    pub triforce_count: i16,
    pub logic_deku_b1_skip: bool,
    // items
    pub biggoron_sword: bool,
    pub blue_fire_arrows: bool,
    pub bombs: bool,
    pub boomerang: bool,
    pub bow: bool,
    pub buy_deku_nut_10: bool,
    pub buy_deku_nut_5: bool,
    pub buy_deku_shield: bool,
    pub buy_deku_stick_1: bool,
    pub defeat_ganon: bool,
    pub defeat_gohma: bool,
    pub deku_back_room_wall: bool,
    pub deku_back_room_web: bool,
    pub deku_basement_block: bool,
    pub deku_basement_scrubs: bool,
    pub deku_basement_switch: bool,
    pub deku_basement_web: bool,
    pub deku_lobby_web: bool,
    pub deku_nut_drop: bool,
    pub deku_shield_drop: bool,
    pub deku_slingshot_scrub: bool,
    pub deku_stick_drop: bool,
    pub dins_fire: bool,
    pub farores_wind: bool,
    pub fire_arrows: bool,
    pub gold_skulltula_token: i8,
    pub goron_tunic: bool,
    pub hookshot: bool,
    pub hover_boots: bool,
    pub hylian_shield: bool,
    pub iron_boots: bool,
    pub kokiri_emerald: bool,
    pub kokiri_sword: bool,
    pub lens_of_truth: bool,
    pub light_arrows: bool,
    pub magic_meter: bool,
    pub megaton_hammer: bool,
    pub minuet_of_forest: bool,
    pub mirror_shield: bool,
    pub nayrus_love: bool,
    pub ocarina: bool,
    pub showed_mido: bool,
    pub slingshot: bool,
    pub triforce_piece: i16,
    pub zora_tunic: bool,
    // other
    pub status: EnumMap<LocationId, Status>,
    visits: i32,
    skips: i32,
}

impl Default for Context {
    fn default() -> Context {
        Context {
            position: SpotId::KF__Links_House__Start_Point,
            save: SpotId::KF__Links_House__Start_Point,
            child: true,
            tod: enums::Tod::Day,
            rupees: 0,
            deku_tree__compass_room__ctx__torch: false,
            // settings
            triforce_count: Default::default(),
            logic_deku_b1_skip: Default::default(),
            // items
            biggoron_sword: Default::default(),
            blue_fire_arrows: Default::default(),
            bombs: Default::default(),
            boomerang: Default::default(),
            bow: Default::default(),
            buy_deku_nut_10: Default::default(),
            buy_deku_nut_5: Default::default(),
            buy_deku_shield: Default::default(),
            buy_deku_stick_1: Default::default(),
            defeat_ganon: Default::default(),
            defeat_gohma: Default::default(),
            deku_back_room_wall: Default::default(),
            deku_back_room_web: Default::default(),
            deku_basement_block: Default::default(),
            deku_basement_scrubs: Default::default(),
            deku_basement_switch: Default::default(),
            deku_basement_web: Default::default(),
            deku_lobby_web: Default::default(),
            deku_nut_drop: Default::default(),
            deku_shield_drop: Default::default(),
            deku_slingshot_scrub: Default::default(),
            deku_stick_drop: Default::default(),
            dins_fire: Default::default(),
            farores_wind: Default::default(),
            fire_arrows: Default::default(),
            gold_skulltula_token: Default::default(),
            goron_tunic: Default::default(),
            hookshot: Default::default(),
            hover_boots: Default::default(),
            hylian_shield: Default::default(),
            iron_boots: Default::default(),
            kokiri_emerald: Default::default(),
            kokiri_sword: Default::default(),
            lens_of_truth: Default::default(),
            light_arrows: Default::default(),
            magic_meter: Default::default(),
            megaton_hammer: Default::default(),
            minuet_of_forest: Default::default(),
            mirror_shield: Default::default(),
            nayrus_love: Default::default(),
            ocarina: Default::default(),
            showed_mido: Default::default(),
            slingshot: Default::default(),
            triforce_piece: Default::default(),
            zora_tunic: Default::default(),
            // other
            status: Default::default(),
            visits: Default::default(),
            skips: Default::default(),
        }
    }
}

impl context::Ctx for Context {
    type World = graph::World;
    type ItemId = Item;
    type AreaId = AreaId;
    type RegionId = RegionId;
    const NUM_ITEMS: i32 = 45;

    fn has(&self, item: Item) -> bool {
        match item {
            Item::Biggoron_Sword => self.biggoron_sword,
            Item::Blue_Fire_Arrows => self.blue_fire_arrows,
            Item::Bombs => self.bombs,
            Item::Boomerang => self.boomerang,
            Item::Bow => self.bow,
            Item::Buy_Deku_Nut_10 => self.buy_deku_nut_10,
            Item::Buy_Deku_Nut_5 => self.buy_deku_nut_5,
            Item::Buy_Deku_Shield => self.buy_deku_shield,
            Item::Buy_Deku_Stick_1 => self.buy_deku_stick_1,
            Item::Defeat_Ganon => self.defeat_ganon,
            Item::Defeat_Gohma => self.defeat_gohma,
            Item::Deku_Back_Room_Wall => self.deku_back_room_wall,
            Item::Deku_Back_Room_Web => self.deku_back_room_web,
            Item::Deku_Basement_Block => self.deku_basement_block,
            Item::Deku_Basement_Scrubs => self.deku_basement_scrubs,
            Item::Deku_Basement_Switch => self.deku_basement_switch,
            Item::Deku_Basement_Web => self.deku_basement_web,
            Item::Deku_Lobby_Web => self.deku_lobby_web,
            Item::Deku_Nut_Drop => self.deku_nut_drop,
            Item::Deku_Shield_Drop => self.deku_shield_drop,
            Item::Deku_Slingshot_Scrub => self.deku_slingshot_scrub,
            Item::Deku_Stick_Drop => self.deku_stick_drop,
            Item::Dins_Fire => self.dins_fire,
            Item::Farores_Wind => self.farores_wind,
            Item::Fire_Arrows => self.fire_arrows,
            Item::Gold_Skulltula_Token => self.gold_skulltula_token >= 1,
            Item::Goron_Tunic => self.goron_tunic,
            Item::Hookshot => self.hookshot,
            Item::Hover_Boots => self.hover_boots,
            Item::Hylian_Shield => self.hylian_shield,
            Item::Iron_Boots => self.iron_boots,
            Item::Kokiri_Emerald => self.kokiri_emerald,
            Item::Kokiri_Sword => self.kokiri_sword,
            Item::Lens_of_Truth => self.lens_of_truth,
            Item::Light_Arrows => self.light_arrows,
            Item::Magic_Meter => self.magic_meter,
            Item::Megaton_Hammer => self.megaton_hammer,
            Item::Minuet_of_Forest => self.minuet_of_forest,
            Item::Mirror_Shield => self.mirror_shield,
            Item::Nayrus_Love => self.nayrus_love,
            Item::Ocarina => self.ocarina,
            Item::Showed_Mido => self.showed_mido,
            Item::Slingshot => self.slingshot,
            Item::Triforce_Piece => self.triforce_piece >= 1,
            Item::Zora_Tunic => self.zora_tunic,
            _ => false,
        }
    }
    fn count(&self, item: Item) -> i16 {
        match item {
            Item::Biggoron_Sword => self.biggoron_sword.into(),
            Item::Blue_Fire_Arrows => self.blue_fire_arrows.into(),
            Item::Bombs => self.bombs.into(),
            Item::Boomerang => self.boomerang.into(),
            Item::Bow => self.bow.into(),
            Item::Buy_Deku_Nut_10 => self.buy_deku_nut_10.into(),
            Item::Buy_Deku_Nut_5 => self.buy_deku_nut_5.into(),
            Item::Buy_Deku_Shield => self.buy_deku_shield.into(),
            Item::Buy_Deku_Stick_1 => self.buy_deku_stick_1.into(),
            Item::Defeat_Ganon => self.defeat_ganon.into(),
            Item::Defeat_Gohma => self.defeat_gohma.into(),
            Item::Deku_Back_Room_Wall => self.deku_back_room_wall.into(),
            Item::Deku_Back_Room_Web => self.deku_back_room_web.into(),
            Item::Deku_Basement_Block => self.deku_basement_block.into(),
            Item::Deku_Basement_Scrubs => self.deku_basement_scrubs.into(),
            Item::Deku_Basement_Switch => self.deku_basement_switch.into(),
            Item::Deku_Basement_Web => self.deku_basement_web.into(),
            Item::Deku_Lobby_Web => self.deku_lobby_web.into(),
            Item::Deku_Nut_Drop => self.deku_nut_drop.into(),
            Item::Deku_Shield_Drop => self.deku_shield_drop.into(),
            Item::Deku_Slingshot_Scrub => self.deku_slingshot_scrub.into(),
            Item::Deku_Stick_Drop => self.deku_stick_drop.into(),
            Item::Dins_Fire => self.dins_fire.into(),
            Item::Farores_Wind => self.farores_wind.into(),
            Item::Fire_Arrows => self.fire_arrows.into(),
            Item::Gold_Skulltula_Token => self.gold_skulltula_token.into(),
            Item::Goron_Tunic => self.goron_tunic.into(),
            Item::Hookshot => self.hookshot.into(),
            Item::Hover_Boots => self.hover_boots.into(),
            Item::Hylian_Shield => self.hylian_shield.into(),
            Item::Iron_Boots => self.iron_boots.into(),
            Item::Kokiri_Emerald => self.kokiri_emerald.into(),
            Item::Kokiri_Sword => self.kokiri_sword.into(),
            Item::Lens_of_Truth => self.lens_of_truth.into(),
            Item::Light_Arrows => self.light_arrows.into(),
            Item::Magic_Meter => self.magic_meter.into(),
            Item::Megaton_Hammer => self.megaton_hammer.into(),
            Item::Minuet_of_Forest => self.minuet_of_forest.into(),
            Item::Mirror_Shield => self.mirror_shield.into(),
            Item::Nayrus_Love => self.nayrus_love.into(),
            Item::Ocarina => self.ocarina.into(),
            Item::Showed_Mido => self.showed_mido.into(),
            Item::Slingshot => self.slingshot.into(),
            Item::Triforce_Piece => self.triforce_piece.into(),
            Item::Zora_Tunic => self.zora_tunic.into(),
            _ => 0,
        }
    }
    fn collect(&mut self, item: Item) {
        match item {
            Item::Biggoron_Sword => {
                self.biggoron_sword = true;
            }
            Item::Blue_Fire_Arrows => {
                self.blue_fire_arrows = true;
            }
            Item::Bombs => {
                self.bombs = true;
            }
            Item::Boomerang => {
                self.boomerang = true;
            }
            Item::Bow => {
                self.bow = true;
            }
            Item::Buy_Deku_Nut_10 => {
                self.buy_deku_nut_10 = true;
            }
            Item::Buy_Deku_Nut_5 => {
                self.buy_deku_nut_5 = true;
            }
            Item::Buy_Deku_Shield => {
                self.buy_deku_shield = true;
            }
            Item::Buy_Deku_Stick_1 => {
                self.buy_deku_stick_1 = true;
            }
            Item::Defeat_Ganon => {
                self.defeat_ganon = true;
            }
            Item::Defeat_Gohma => {
                self.defeat_gohma = true;
            }
            Item::Deku_Back_Room_Wall => {
                self.deku_back_room_wall = true;
            }
            Item::Deku_Back_Room_Web => {
                self.deku_back_room_web = true;
            }
            Item::Deku_Basement_Block => {
                self.deku_basement_block = true;
            }
            Item::Deku_Basement_Scrubs => {
                self.deku_basement_scrubs = true;
            }
            Item::Deku_Basement_Switch => {
                self.deku_basement_switch = true;
            }
            Item::Deku_Basement_Web => {
                self.deku_basement_web = true;
            }
            Item::Deku_Lobby_Web => {
                self.deku_lobby_web = true;
            }
            Item::Deku_Nut_Drop => {
                self.deku_nut_drop = true;
            }
            Item::Deku_Shield_Drop => {
                self.deku_shield_drop = true;
            }
            Item::Deku_Slingshot_Scrub => {
                self.deku_slingshot_scrub = true;
            }
            Item::Deku_Stick_Drop => {
                self.deku_stick_drop = true;
            }
            Item::Dins_Fire => {
                self.dins_fire = true;
            }
            Item::Farores_Wind => {
                self.farores_wind = true;
            }
            Item::Fire_Arrows => {
                self.fire_arrows = true;
            }
            Item::Gold_Skulltula_Token => {
                self.gold_skulltula_token += 1;
            }
            Item::Goron_Tunic => {
                self.goron_tunic = true;
            }
            Item::Hookshot => {
                self.hookshot = true;
            }
            Item::Hover_Boots => {
                self.hover_boots = true;
            }
            Item::Hylian_Shield => {
                self.hylian_shield = true;
            }
            Item::Iron_Boots => {
                self.iron_boots = true;
            }
            Item::Kokiri_Emerald => {
                self.kokiri_emerald = true;
            }
            Item::Kokiri_Sword => {
                self.kokiri_sword = true;
            }
            Item::Lens_of_Truth => {
                self.lens_of_truth = true;
            }
            Item::Light_Arrows => {
                self.light_arrows = true;
            }
            Item::Magic_Meter => {
                self.magic_meter = true;
            }
            Item::Megaton_Hammer => {
                self.megaton_hammer = true;
            }
            Item::Minuet_of_Forest => {
                self.minuet_of_forest = true;
            }
            Item::Mirror_Shield => {
                self.mirror_shield = true;
            }
            Item::Nayrus_Love => {
                self.nayrus_love = true;
            }
            Item::Ocarina => {
                self.ocarina = true;
            }
            Item::Showed_Mido => {
                self.showed_mido = true;
            }
            Item::Slingshot => {
                self.slingshot = true;
            }
            Item::Triforce_Piece => {
                self.triforce_piece += 1;
            }
            Item::Zora_Tunic => {
                self.zora_tunic = true;
            }
            Item::Rupee_1 => rules::action_rupees__min__rupees__1_wallet_max(self),
            Item::Rupees_5 => rules::action_rupees__min__rupees__5_wallet_max(self),
            Item::Rupees_50 => rules::action_rupees__min__rupees__50_wallet_max(self),
            _ => (),
        }
    }

    fn position(&self) -> SpotId {
        self.position
    }
    fn set_position(&mut self, pos: SpotId) {
        match get_area(pos) {
            AreaId::Deku_Tree__Compass_Room => {
                if get_area(self.position) != AreaId::Deku_Tree__Compass_Room {
                    self.deku_tree__compass_room__ctx__torch = false;
                }
            }
            _ => (),
        }
        self.position = pos;
    }

    fn reload_game(&mut self) {
        self.reset_all();
    }

    fn reset_all(&mut self) {}

    fn reset_region(&mut self, region_id: RegionId) {}
    fn reset_area(&mut self, area_id: AreaId) {}
    fn can_afford(&self, cost: &Currency) -> bool {
        match cost {
            Currency::Free => true,
            Currency::Rupees(c) => self.rupees >= *c,
        }
    }
    fn spend(&mut self, cost: &Currency) {
        match cost {
            Currency::Free => (),
            Currency::Rupees(c) => self.rupees -= *c,
        }
    }

    fn visit(&mut self, loc_id: LocationId) {
        self.status[loc_id] = Status::Visited;
        self.visits += 1;
    }
    fn skip(&mut self, loc_id: LocationId) {
        self.status[loc_id] = Status::Skipped;
        self.skips += 1;
    }
    fn reset(&mut self, loc_id: LocationId) {
        match self.status[loc_id] {
            Status::Visited => self.visits -= 1,
            Status::Skipped => self.skips -= 1,
            _ => (),
        }
        self.status[loc_id] = Status::None;
    }

    fn todo(&self, loc_id: LocationId) -> bool {
        self.status[loc_id] == Status::None
    }
    fn visited(&self, loc_id: LocationId) -> bool {
        self.status[loc_id] == Status::Visited
    }
    fn skipped(&self, loc_id: LocationId) -> bool {
        self.status[loc_id] == Status::Skipped
    }

    fn all_spot_checks(&self, id: SpotId) -> bool {
        let r = spot_locations(id);
        for status in self.status.as_slice()[r.start..r.end].iter() {
            if status == &Status::None {
                return false;
            }
        }
        true
    }
    fn all_area_checks(&self, id: AreaId) -> bool {
        let r = area_locations(id);
        for status in self.status.as_slice()[r.start..r.end].iter() {
            if status == &Status::None {
                return false;
            }
        }
        true
    }
    fn all_region_checks(&self, id: RegionId) -> bool {
        let r = region_locations(id);
        for status in self.status.as_slice()[r.start..r.end].iter() {
            if status == &Status::None {
                return false;
            }
        }
        true
    }
    fn local_travel_time(&self, dest: SpotId) -> i32 {
        movements::local_travel_time(self, self.position, dest)
    }

    fn count_visits(&self) -> i32 {
        self.visits
    }
    fn count_skips(&self) -> i32 {
        self.skips
    }
    fn progress(&self) -> i32 {
        if self.visits <= 0 {
            0
        } else {
            self.visits * 100 / (Self::World::NUM_LOCATIONS - self.skips)
        }
    }
}

impl Context {
    pub fn position(&self) -> SpotId {
        match get_area(self.position) {
            _ => match get_region(self.position) {
                _ => self.position,
            },
        }
    }
    pub fn save(&self) -> SpotId {
        match get_area(self.position) {
            _ => match get_region(self.position) {
                RegionId::Deku_Tree => SpotId::Deku_Tree__Lobby__Entry,
                _ => self.save,
            },
        }
    }
    pub fn child(&self) -> bool {
        match get_area(self.position) {
            _ => match get_region(self.position) {
                _ => self.child,
            },
        }
    }
    pub fn tod(&self) -> enums::Tod {
        match get_area(self.position) {
            _ => match get_region(self.position) {
                _ => self.tod,
            },
        }
    }
    pub fn rupees(&self) -> i32 {
        match get_area(self.position) {
            _ => match get_region(self.position) {
                _ => self.rupees,
            },
        }
    }
    pub fn deku_tree__compass_room__ctx__torch(&self) -> bool {
        match get_area(self.position) {
            _ => match get_region(self.position) {
                _ => self.deku_tree__compass_room__ctx__torch,
            },
        }
    }
}
